"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[745],{1745:(Yt,N0,_)=>{_.r(N0),_.d(N0,{GamesModule:()=>kt});var S=_(163),M=_(9804),I=_(7791),a0=_(8575),oe=_(3887),ce=_(1829);function C(i,e){const t="object"==typeof e;return new Promise((n,s)=>{const o=new ce.Hp({next:a=>{n(a),o.unsubscribe()},error:s,complete:()=>{t?n(e.defaultValue):s(new oe.K)}});i.subscribe(o)})}var de=_(3149),r=_(7487);class M0{constructor(e=!1,t,n=!0){this._multiple=e,this._emitChanges=n,this._selection=new Set,this._deselectedToEmit=[],this._selectedToEmit=[],this.changed=new de.x,t&&t.length&&(e?t.forEach(s=>this._markSelected(s)):this._markSelected(t[0]),this._selectedToEmit.length=0)}get selected(){return this._selected||(this._selected=Array.from(this._selection.values())),this._selected}select(...e){this._verifyValueAssignment(e),e.forEach(t=>this._markSelected(t)),this._emitChangeEvent()}deselect(...e){this._verifyValueAssignment(e),e.forEach(t=>this._unmarkSelected(t)),this._emitChangeEvent()}toggle(e){this.isSelected(e)?this.deselect(e):this.select(e)}clear(){this._unmarkAll(),this._emitChangeEvent()}isSelected(e){return this._selection.has(e)}isEmpty(){return 0===this._selection.size}hasValue(){return!this.isEmpty()}sort(e){this._multiple&&this.selected&&this._selected.sort(e)}isMultipleSelection(){return this._multiple}_emitChangeEvent(){this._selected=null,(this._selectedToEmit.length||this._deselectedToEmit.length)&&(this.changed.next({source:this,added:this._selectedToEmit,removed:this._deselectedToEmit}),this._deselectedToEmit=[],this._selectedToEmit=[])}_markSelected(e){this.isSelected(e)||(this._multiple||this._unmarkAll(),this._selection.add(e),this._emitChanges&&this._selectedToEmit.push(e))}_unmarkSelected(e){this.isSelected(e)&&(this._selection.delete(e),this._emitChanges&&this._deselectedToEmit.push(e))}_unmarkAll(){this.isEmpty()||this._selection.forEach(e=>this._unmarkSelected(e))}_verifyValueAssignment(e){}}var v=_(1390);const $0=["A","B","C","D","E","F","G","H","I","J"],Z0=[1,2,3,4,5,6,7,8,9,10],z=10;var $=(()=>{return(i=$||($={})).Carrier="CA",i.Battleship="B",i.Cruiser="CR",i.Submarine="S",i.Destroyer="D",$;var i})();const S0=[{id:$.Carrier,name:"Carrier",length:5},{id:$.Battleship,name:"Battleship",length:4},{id:$.Cruiser,name:"Cruiser",length:3},{id:$.Submarine,name:"Submarine",length:3},{id:$.Destroyer,name:"Destroyer",length:2}];function fe(i,e){if(1&i&&(r.TgZ(0,"th"),r._uU(1),r.qZA()),2&i){const t=e.$implicit;r.xp6(1),r.Oqu(t)}}function le(i,e){if(1&i&&(r.TgZ(0,"td",11)(1,"span"),r._uU(2),r.qZA()()),2&i){const t=e.ngIf;r.xp6(2),r.Oqu(t.id)}}function ue(i,e){if(1&i){const t=r.EpF();r.TgZ(0,"td",12),r.NdJ("click",function(){r.CHM(t);const s=r.oxw().index,o=r.oxw().index;return r.oxw().placeSelectedShip(s,o)}),r.qZA()}}function be(i,e){if(1&i&&(r.ynx(0),r.YNc(1,le,3,1,"td",9),r.YNc(2,ue,1,0,"ng-template",null,10,r.W1O),r.BQk()),2&i){const t=e.index,n=r.MAs(3),s=r.oxw().index,o=r.oxw();r.xp6(1),r.Q6J("ngIf",o.occupancyBoard[t][s])("ngIfElse",n)}}function pe(i,e){if(1&i&&(r.TgZ(0,"tr")(1,"th"),r._uU(2),r.qZA(),r.YNc(3,be,4,2,"ng-container",2),r.qZA()),2&i){const t=e.$implicit,n=r.oxw();r.xp6(2),r.Oqu(t),r.xp6(1),r.Q6J("ngForOf",n.columns)}}function he(i,e){1&i&&(r.TgZ(0,"span",15),r._uU(1,"\u2713"),r.qZA())}function ye(i,e){if(1&i){const t=r.EpF();r.TgZ(0,"li",13),r.NdJ("click",function(){const o=r.CHM(t).$implicit;return r.oxw().shipSelection.toggle(o)}),r._uU(1),r.YNc(2,he,2,0,"span",14),r.qZA()}if(2&i){const t=e.$implicit,n=r.oxw();r.ekj("active",n.shipSelection.isSelected(t)),r.xp6(1),r.lnq(" ",t.name," (",t.id," - ",t.length,") "),r.xp6(1),r.Q6J("ngIf",n.hasPlacedShip(t))}}let s0=(()=>{class i{constructor(){this.ShipType=$,this.ships=S0,this.columns=$0,this.rows=Z0,this.fleetConfiguration$=new a0.X([void 0,void 0,void 0,void 0,void 0]),this.fleetComplete$=this.fleetConfiguration$.pipe((0,v.U)(t=>t.every(n=>!!n))),this.shipSelection=new M0,this.placeShipsHorizontally=!0,this.occupancyBoard=[];for(let t=0;t<z;t++)this.occupancyBoard.push(new Array(z).fill(void 0))}ngOnInit(){}placeSelectedShip(t,n){const s=this.shipSelection.selected[0];this.shipPlacementOnBoardInvalid(s,t,n)||(this.removeShipFromBoard(s),this.placeShip(s,t,n),this.shipSelection.clear())}toggleShipPlacementOrientation(){this.placeShipsHorizontally=!this.placeShipsHorizontally}hasPlacedShip(t){const n=this.ships.indexOf(t);return!!this.fleetConfiguration$.value[n]}shipPlacementOnBoardInvalid(t,n,s){const o=(this.placeShipsHorizontally?n:s)+t.length-1;if(o>=z)return!0;if(this.placeShipsHorizontally){for(let a=n;a<o+1;a++)if(void 0!==this.occupancyBoard[a][s]&&this.occupancyBoard[a][s]!==t)return!0}else for(let a=s;a<o+1;a++)if(void 0!==this.occupancyBoard[n][a]&&this.occupancyBoard[n][a]!==t)return!0;return!1}placeShip(t,n,s){const o=this.ships.indexOf(t),a=this.fleetConfiguration$.value;if(a[o]=[BigInt(n),BigInt(s),this.placeShipsHorizontally?BigInt(0):BigInt(1)],this.fleetConfiguration$.next(a),this.placeShipsHorizontally)for(let c=n;c<n+t.length;c++)this.occupancyBoard[c][s]=t;else for(let c=s;c<s+t.length;c++)this.occupancyBoard[n][c]=t}removeShipFromBoard(t){const n=this.ships.indexOf(t),s=this.fleetConfiguration$.value;s[n]=void 0,this.fleetConfiguration$.next(s);for(let o=0;o<z;o++)for(let a=0;a<z;a++)this.occupancyBoard[o][a]===t&&(this.occupancyBoard[o][a]=void 0)}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-fleet-setup-board"]],decls:14,vars:4,consts:[[1,"d-flex","justify-content-center"],[1,"flex-2","m-5"],[4,"ngFor","ngForOf"],[1,"card","border-primary","flex-1","m-5",2,"max-width","20rem"],[1,"card-header"],[1,"list-group","list-group-flush"],["class","list-group-item list-group-item-action d-flex justify-content-between align-items-center",3,"active","click",4,"ngFor","ngForOf"],[1,"card-body"],[1,"btn","btn-outline-primary",3,"click"],["class","ship-present",4,"ngIf","ngIfElse"],["noShipCell",""],[1,"ship-present"],[3,"click"],[1,"list-group-item","list-group-item-action","d-flex","justify-content-between","align-items-center",3,"click"],["class","badge bg-secondary",4,"ngIf"],[1,"badge","bg-secondary"]],template:function(t,n){1&t&&(r.TgZ(0,"div",0)(1,"table",1)(2,"tr"),r._UZ(3,"th"),r.YNc(4,fe,2,1,"th",2),r.qZA(),r.YNc(5,pe,4,2,"tr",2),r.qZA(),r.TgZ(6,"div",3)(7,"h2",4),r._uU(8,"Your Fleet"),r.qZA(),r.TgZ(9,"ul",5),r.YNc(10,ye,3,6,"li",6),r.qZA(),r.TgZ(11,"div",7)(12,"button",8),r.NdJ("click",function(){return n.toggleShipPlacementOrientation()}),r._uU(13),r.qZA()()()()),2&t&&(r.xp6(4),r.Q6J("ngForOf",n.columns),r.xp6(1),r.Q6J("ngForOf",n.rows),r.xp6(5),r.Q6J("ngForOf",n.ships),r.xp6(3),r.hij(" ship orientation: ",n.placeShipsHorizontally?"horizontal":"vertical"," "))},directives:[S.sg,S.O5],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:48px;height:48px;text-align:center}td[_ngcontent-%COMP%]{border:1px solid #1a1a1a}td[_ngcontent-%COMP%]:hover{background-color:#eceeef}.card[_ngcontent-%COMP%]{margin-top:calc(3rem + 48px)!important}"]}),i})();function V0(){return BigInt(Math.floor(Math.random()*10**8))}var o0=_(1899);const c0="assets/circuits";let v0=(()=>{class i{constructor(t){this.snarkjs=t.defaultView.snarkjs}generateBoardSetupProof(t,n){var s=this;return(0,I.Z)(function*(){const{proof:o,publicSignals:a}=yield s.snarkjs.groth16.fullProve({ships:t,trapdoor:n},`${c0}/boardsetup/boardsetup.wasm`,`${c0}/boardsetup/boardsetup_final.zkey`);return{...s.parseGroth16Proof(o),boardHash:BigInt(a[0])}})()}generateFireShotProof(t,n,s,o){var a=this;return(0,I.Z)(function*(){const{proof:c,publicSignals:f}=yield a.snarkjs.groth16.fullProve({ships:t,trapdoor:n,hash:s,shotIndex:o},`${c0}/fireshot/fireshot.wasm`,`${c0}/fireshot/fireshot_final.zkey`);return{...a.parseGroth16Proof(c),hitShipId:BigInt(f[0])}})()}parseGroth16Proof({pi_a:t,pi_b:n,pi_c:s}){return{pi_a:[BigInt(t[0]),BigInt(t[1])],pi_b:[[BigInt(n[0][1]),BigInt(n[0][0])],[BigInt(n[1][1]),BigInt(n[1][0])]],pi_c:[BigInt(s[0]),BigInt(s[1])]}}}return i.\u0275fac=function(t){return new(t||i)(r.LFG(S.K0))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var E=_(8781),b=_(469),G=_(7498),l=_(2339),h=_(3615);const H="abi/5.6.1",x0=new h.Yd(H);class Z{constructor(e,t,n,s){this.name=e,this.type=t,this.localName=n,this.dynamic=s}_throwError(e,t){x0.throwArgumentError(e,this.localName,t)}}class E0{constructor(e){(0,l.zG)(this,"wordSize",e||32),this._data=[],this._dataLength=0,this._padding=new Uint8Array(e)}get data(){return(0,b.xs)(this._data)}get length(){return this._dataLength}_writeData(e){return this._data.push(e),this._dataLength+=e.length,e.length}appendWriter(e){return this._writeData((0,b.zo)(e._data))}writeBytes(e){let t=(0,b.lE)(e);const n=t.length%this.wordSize;return n&&(t=(0,b.zo)([t,this._padding.slice(n)])),this._writeData(t)}_getValue(e){let t=(0,b.lE)(G.O$.from(e));return t.length>this.wordSize&&x0.throwError("value out-of-bounds",h.Yd.errors.BUFFER_OVERRUN,{length:this.wordSize,offset:t.length}),t.length%this.wordSize&&(t=(0,b.zo)([this._padding.slice(t.length%this.wordSize),t])),t}writeValue(e){return this._writeData(this._getValue(e))}writeUpdatableValue(){const e=this._data.length;return this._data.push(this._padding),this._dataLength+=this.wordSize,t=>{this._data[e]=this._getValue(t)}}}class d0{constructor(e,t,n,s){(0,l.zG)(this,"_data",(0,b.lE)(e)),(0,l.zG)(this,"wordSize",t||32),(0,l.zG)(this,"_coerceFunc",n),(0,l.zG)(this,"allowLoose",s),this._offset=0}get data(){return(0,b.Dv)(this._data)}get consumed(){return this._offset}static coerce(e,t){let n=e.match("^u?int([0-9]+)$");return n&&parseInt(n[1])<=48&&(t=t.toNumber()),t}coerce(e,t){return this._coerceFunc?this._coerceFunc(e,t):d0.coerce(e,t)}_peekBytes(e,t,n){let s=Math.ceil(t/this.wordSize)*this.wordSize;return this._offset+s>this._data.length&&(this.allowLoose&&n&&this._offset+t<=this._data.length?s=t:x0.throwError("data out-of-bounds",h.Yd.errors.BUFFER_OVERRUN,{length:this._data.length,offset:this._offset+s})),this._data.slice(this._offset,this._offset+s)}subReader(e){return new d0(this._data.slice(this._offset+e),this.wordSize,this._coerceFunc,this.allowLoose)}readBytes(e,t){let n=this._peekBytes(0,e,!!t);return this._offset+=n.length,n.slice(0,e)}readValue(){return G.O$.from(this.readBytes(this.wordSize))}}var D=_(3781),f0=_(9167),z0=_(2640);class ge extends Z{constructor(e){super("address","address",e,!1)}defaultValue(){return"0x0000000000000000000000000000000000000000"}encode(e,t){try{t=(0,D.Kn)(t)}catch(n){this._throwError(n.message,t)}return e.writeValue(t)}decode(e){return(0,D.Kn)((0,b.$m)(e.readValue().toHexString(),20))}}class _e extends Z{constructor(e){super(e.name,e.type,void 0,e.dynamic),this.coder=e}defaultValue(){return this.coder.defaultValue()}encode(e,t){return this.coder.encode(e,t)}decode(e){return this.coder.decode(e)}}const j=new h.Yd(H);function D0(i,e,t){let n=null;if(Array.isArray(t))n=t;else if(t&&"object"==typeof t){let f={};n=e.map(d=>{const u=d.localName;return u||j.throwError("cannot encode object for signature with missing names",h.Yd.errors.INVALID_ARGUMENT,{argument:"values",coder:d,value:t}),f[u]&&j.throwError("cannot encode object for signature with duplicate names",h.Yd.errors.INVALID_ARGUMENT,{argument:"values",coder:d,value:t}),f[u]=!0,t[u]})}else j.throwArgumentError("invalid tuple value","tuple",t);e.length!==n.length&&j.throwArgumentError("types/value length mismatch","tuple",t);let s=new E0(i.wordSize),o=new E0(i.wordSize),a=[];e.forEach((f,d)=>{let u=n[d];if(f.dynamic){let p=o.length;f.encode(o,u);let g=s.writeUpdatableValue();a.push(A=>{g(A+p)})}else f.encode(s,u)}),a.forEach(f=>{f(s.length)});let c=i.appendWriter(s);return c+=i.appendWriter(o),c}function U0(i,e){let t=[],n=i.subReader(0);e.forEach(o=>{let a=null;if(o.dynamic){let c=i.readValue(),f=n.subReader(c.toNumber());try{a=o.decode(f)}catch(d){if(d.code===h.Yd.errors.BUFFER_OVERRUN)throw d;a=d,a.baseType=o.name,a.name=o.localName,a.type=o.type}}else try{a=o.decode(i)}catch(c){if(c.code===h.Yd.errors.BUFFER_OVERRUN)throw c;a=c,a.baseType=o.name,a.name=o.localName,a.type=o.type}null!=a&&t.push(a)});const s=e.reduce((o,a)=>{const c=a.localName;return c&&(o[c]||(o[c]=0),o[c]++),o},{});e.forEach((o,a)=>{let c=o.localName;if(!c||1!==s[c]||("length"===c&&(c="_length"),null!=t[c]))return;const f=t[a];f instanceof Error?Object.defineProperty(t,c,{enumerable:!0,get:()=>{throw f}}):t[c]=f});for(let o=0;o<t.length;o++){const a=t[o];a instanceof Error&&Object.defineProperty(t,o,{enumerable:!0,get:()=>{throw a}})}return Object.freeze(t)}class Te extends Z{constructor(e,t,n){super("array",e.type+"["+(t>=0?t:"")+"]",n,-1===t||e.dynamic),this.coder=e,this.length=t}defaultValue(){const e=this.coder.defaultValue(),t=[];for(let n=0;n<this.length;n++)t.push(e);return t}encode(e,t){Array.isArray(t)||this._throwError("expected array value",t);let n=this.length;-1===n&&(n=t.length,e.writeValue(t.length)),j.checkArgumentCount(t.length,n,"coder array"+(this.localName?" "+this.localName:""));let s=[];for(let o=0;o<t.length;o++)s.push(this.coder);return D0(e,s,t)}decode(e){let t=this.length;-1===t&&(t=e.readValue().toNumber(),32*t>e._data.length&&j.throwError("insufficient data length",h.Yd.errors.BUFFER_OVERRUN,{length:e._data.length,count:t}));let n=[];for(let s=0;s<t;s++)n.push(new _e(this.coder));return e.coerce(this.name,U0(e,n))}}class we extends Z{constructor(e){super("bool","bool",e,!1)}defaultValue(){return!1}encode(e,t){return e.writeValue(t?1:0)}decode(e){return e.coerce(this.type,!e.readValue().isZero())}}class L0 extends Z{constructor(e,t){super(e,e,t,!0)}defaultValue(){return"0x"}encode(e,t){t=(0,b.lE)(t);let n=e.writeValue(t.length);return n+=e.writeBytes(t),n}decode(e){return e.readBytes(e.readValue().toNumber(),!0)}}class Se extends L0{constructor(e){super("bytes",e)}decode(e){return e.coerce(this.name,(0,b.Dv)(super.decode(e)))}}class ve extends Z{constructor(e,t){let n="bytes"+String(e);super(n,n,t,!1),this.size=e}defaultValue(){return"0x0000000000000000000000000000000000000000000000000000000000000000".substring(0,2+2*this.size)}encode(e,t){let n=(0,b.lE)(t);return n.length!==this.size&&this._throwError("incorrect data length",t),e.writeBytes(n)}decode(e){return e.coerce(this.name,(0,b.Dv)(e.readBytes(this.size)))}}class xe extends Z{constructor(e){super("null","",e,!1)}defaultValue(){return null}encode(e,t){return null!=t&&this._throwError("not null",t),e.writeBytes([])}decode(e){return e.readBytes(0),e.coerce(this.name,null)}}var l0=_(1865);class Ee extends Z{constructor(e,t,n){const s=(t?"int":"uint")+8*e;super(s,s,n,!1),this.size=e,this.signed=t}defaultValue(){return 0}encode(e,t){let n=G.O$.from(t),s=l0.Bz.mask(8*e.wordSize);if(this.signed){let o=s.mask(8*this.size-1);(n.gt(o)||n.lt(o.add(l0.fh).mul(l0.tL)))&&this._throwError("value out-of-bounds",t)}else(n.lt(l0._Y)||n.gt(s.mask(8*this.size)))&&this._throwError("value out-of-bounds",t);return n=n.toTwos(8*this.size).mask(8*this.size),this.signed&&(n=n.fromTwos(8*this.size).toTwos(8*e.wordSize)),e.writeValue(n)}decode(e){let t=e.readValue().mask(8*this.size);return this.signed&&(t=t.fromTwos(8*this.size)),e.coerce(this.name,t)}}var k0=_(9089);class Ce extends L0{constructor(e){super("string",e)}defaultValue(){return""}encode(e,t){return super.encode(e,(0,k0.Y0)(t))}decode(e){return(0,k0.ZN)(super.decode(e))}}class u0 extends Z{constructor(e,t){let n=!1;const s=[];e.forEach(a=>{a.dynamic&&(n=!0),s.push(a.type)}),super("tuple","tuple("+s.join(",")+")",t,n),this.coders=e}defaultValue(){const e=[];this.coders.forEach(n=>{e.push(n.defaultValue())});const t=this.coders.reduce((n,s)=>{const o=s.localName;return o&&(n[o]||(n[o]=0),n[o]++),n},{});return this.coders.forEach((n,s)=>{let o=n.localName;!o||1!==t[o]||("length"===o&&(o="_length"),null==e[o]&&(e[o]=e[s]))}),Object.freeze(e)}encode(e,t){return D0(e,this.coders,t)}decode(e){return e.coerce(this.name,U0(e,this.coders))}}const y=new h.Yd(H),k={};let R0={calldata:!0,memory:!0,storage:!0},Ae={calldata:!0,memory:!0};function b0(i,e){if("bytes"===i||"string"===i){if(R0[e])return!0}else if("address"===i){if("payable"===e)return!0}else if((i.indexOf("[")>=0||"tuple"===i)&&Ae[e])return!0;return(R0[e]||"payable"===e)&&y.throwArgumentError("invalid modifier","name",e),!1}function p0(i,e){for(let t in e)(0,l.zG)(i,t,e[t])}const m=Object.freeze({sighash:"sighash",minimal:"minimal",full:"full",json:"json"}),Ie=new RegExp(/^(.*)\[([0-9]*)\]$/);class x{constructor(e,t){e!==k&&y.throwError("use fromString",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new ParamType()"}),p0(this,t);let n=this.type.match(Ie);p0(this,n?{arrayLength:parseInt(n[2]||"-1"),arrayChildren:x.fromObject({type:n[1],components:this.components}),baseType:"array"}:{arrayLength:null,arrayChildren:null,baseType:null!=this.components?"tuple":this.type}),this._isParamType=!0,Object.freeze(this)}format(e){if(e||(e=m.sighash),m[e]||y.throwArgumentError("invalid format type","format",e),e===m.json){let n={type:"tuple"===this.baseType?"tuple":this.type,name:this.name||void 0};return"boolean"==typeof this.indexed&&(n.indexed=this.indexed),this.components&&(n.components=this.components.map(s=>JSON.parse(s.format(e)))),JSON.stringify(n)}let t="";return"array"===this.baseType?(t+=this.arrayChildren.format(e),t+="["+(this.arrayLength<0?"":String(this.arrayLength))+"]"):"tuple"===this.baseType?(e!==m.sighash&&(t+=this.type),t+="("+this.components.map(n=>n.format(e)).join(e===m.full?", ":",")+")"):t+=this.type,e!==m.sighash&&(!0===this.indexed&&(t+=" indexed"),e===m.full&&this.name&&(t+=" "+this.name)),t}static from(e,t){return"string"==typeof e?x.fromString(e,t):x.fromObject(e)}static fromObject(e){return x.isParamType(e)?e:new x(k,{name:e.name||null,type:J(e.type),indexed:null==e.indexed?null:!!e.indexed,components:e.components?e.components.map(x.fromObject):null})}static fromString(e,t){return function n(s){return x.fromObject({name:s.name,type:s.type,indexed:s.indexed,components:s.components})}(function Ge(i,e){let t=i;function n(c){y.throwArgumentError(`unexpected character at position ${c}`,"param",i)}function s(c){let f={type:"",name:"",parent:c,state:{allowType:!0}};return e&&(f.indexed=!1),f}i=i.replace(/\s/g," ");let o={type:"",name:"",state:{allowType:!0}},a=o;for(let c=0;c<i.length;c++){let f=i[c];switch(f){case"(":a.state.allowType&&""===a.type?a.type="tuple":a.state.allowParams||n(c),a.state.allowType=!1,a.type=J(a.type),a.components=[s(a)],a=a.components[0];break;case")":delete a.state,"indexed"===a.name&&(e||n(c),a.indexed=!0,a.name=""),b0(a.type,a.name)&&(a.name=""),a.type=J(a.type);let d=a;a=a.parent,a||n(c),delete d.parent,a.state.allowParams=!1,a.state.allowName=!0,a.state.allowArray=!0;break;case",":delete a.state,"indexed"===a.name&&(e||n(c),a.indexed=!0,a.name=""),b0(a.type,a.name)&&(a.name=""),a.type=J(a.type);let u=s(a.parent);a.parent.components.push(u),delete a.parent,a=u;break;case" ":a.state.allowType&&""!==a.type&&(a.type=J(a.type),delete a.state.allowType,a.state.allowName=!0,a.state.allowParams=!0),a.state.allowName&&""!==a.name&&("indexed"===a.name?(e||n(c),a.indexed&&n(c),a.indexed=!0,a.name=""):b0(a.type,a.name)?a.name="":a.state.allowName=!1);break;case"[":a.state.allowArray||n(c),a.type+=f,a.state.allowArray=!1,a.state.allowName=!1,a.state.readArray=!0;break;case"]":a.state.readArray||n(c),a.type+=f,a.state.readArray=!1,a.state.allowArray=!0,a.state.allowName=!0;break;default:a.state.allowType?(a.type+=f,a.state.allowParams=!0,a.state.allowArray=!0):a.state.allowName?(a.name+=f,delete a.state.allowArray):a.state.readArray?a.type+=f:n(c)}}return a.parent&&y.throwArgumentError("unexpected eof","param",i),delete o.state,"indexed"===a.name?(e||n(t.length-7),a.indexed&&n(t.length-7),a.indexed=!0,a.name=""):b0(a.type,a.name)&&(a.name=""),o.type=J(o.type),o}(e,!!t))}static isParamType(e){return!(null==e||!e._isParamType)}}function W(i,e){return function Oe(i){i=i.trim();let e=[],t="",n=0;for(let s=0;s<i.length;s++){let o=i[s];","===o&&0===n?(e.push(t),t=""):(t+=o,"("===o?n++:")"===o&&(n--,-1===n&&y.throwArgumentError("unbalanced parenthesis","value",i)))}return t&&e.push(t),e}(i).map(t=>x.fromString(t,e))}class F{constructor(e,t){e!==k&&y.throwError("use a static from method",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new Fragment()"}),p0(this,t),this._isFragment=!0,Object.freeze(this)}static from(e){return F.isFragment(e)?e:"string"==typeof e?F.fromString(e):F.fromObject(e)}static fromObject(e){if(F.isFragment(e))return e;switch(e.type){case"function":return B.fromObject(e);case"event":return V.fromObject(e);case"constructor":return O.fromObject(e);case"error":return U.fromObject(e);case"fallback":case"receive":return null}return y.throwArgumentError("invalid fragment object","value",e)}static fromString(e){return"event"===(e=(e=(e=e.replace(/\s/g," ")).replace(/\(/g," (").replace(/\)/g,") ").replace(/\s+/g," ")).trim()).split(" ")[0]?V.fromString(e.substring(5).trim()):"function"===e.split(" ")[0]?B.fromString(e.substring(8).trim()):"constructor"===e.split("(")[0].trim()?O.fromString(e.trim()):"error"===e.split(" ")[0]?U.fromString(e.substring(5).trim()):y.throwArgumentError("unsupported fragment","value",e)}static isFragment(e){return!(!e||!e._isFragment)}}class V extends F{format(e){if(e||(e=m.sighash),m[e]||y.throwArgumentError("invalid format type","format",e),e===m.json)return JSON.stringify({type:"event",anonymous:this.anonymous,name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});let t="";return e!==m.sighash&&(t+="event "),t+=this.name+"("+this.inputs.map(n=>n.format(e)).join(e===m.full?", ":",")+") ",e!==m.sighash&&this.anonymous&&(t+="anonymous "),t.trim()}static from(e){return"string"==typeof e?V.fromString(e):V.fromObject(e)}static fromObject(e){if(V.isEventFragment(e))return e;"event"!==e.type&&y.throwArgumentError("invalid event object","value",e);const t={name:X(e.name),anonymous:e.anonymous,inputs:e.inputs?e.inputs.map(x.fromObject):[],type:"event"};return new V(k,t)}static fromString(e){let t=e.match(K);t||y.throwArgumentError("invalid event string","value",e);let n=!1;return t[3].split(" ").forEach(s=>{switch(s.trim()){case"anonymous":n=!0;break;case"":break;default:y.warn("unknown modifier: "+s)}}),V.fromObject({name:t[1].trim(),anonymous:n,inputs:W(t[2],!0),type:"event"})}static isEventFragment(e){return e&&e._isFragment&&"event"===e.type}}function j0(i,e){e.gas=null;let t=i.split("@");return 1!==t.length?(t.length>2&&y.throwArgumentError("invalid human-readable ABI signature","value",i),t[1].match(/^[0-9]+$/)||y.throwArgumentError("invalid human-readable ABI signature gas","value",i),e.gas=G.O$.from(t[1]),t[0]):i}function J0(i,e){e.constant=!1,e.payable=!1,e.stateMutability="nonpayable",i.split(" ").forEach(t=>{switch(t.trim()){case"constant":e.constant=!0;break;case"payable":e.payable=!0,e.stateMutability="payable";break;case"nonpayable":e.payable=!1,e.stateMutability="nonpayable";break;case"pure":e.constant=!0,e.stateMutability="pure";break;case"view":e.constant=!0,e.stateMutability="view";break;case"external":case"public":case"":break;default:console.log("unknown modifier: "+t)}})}function Y0(i){let e={constant:!1,payable:!0,stateMutability:"payable"};return null!=i.stateMutability?(e.stateMutability=i.stateMutability,e.constant="view"===e.stateMutability||"pure"===e.stateMutability,null!=i.constant&&!!i.constant!==e.constant&&y.throwArgumentError("cannot have constant function with mutability "+e.stateMutability,"value",i),e.payable="payable"===e.stateMutability,null!=i.payable&&!!i.payable!==e.payable&&y.throwArgumentError("cannot have payable function with mutability "+e.stateMutability,"value",i)):null!=i.payable?(e.payable=!!i.payable,null==i.constant&&!e.payable&&"constructor"!==i.type&&y.throwArgumentError("unable to determine stateMutability","value",i),e.constant=!!i.constant,e.stateMutability=e.constant?"view":e.payable?"payable":"nonpayable",e.payable&&e.constant&&y.throwArgumentError("cannot have constant payable function","value",i)):null!=i.constant?(e.constant=!!i.constant,e.payable=!e.constant,e.stateMutability=e.constant?"view":"payable"):"constructor"!==i.type&&y.throwArgumentError("unable to determine stateMutability","value",i),e}class O extends F{format(e){if(e||(e=m.sighash),m[e]||y.throwArgumentError("invalid format type","format",e),e===m.json)return JSON.stringify({type:"constructor",stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});e===m.sighash&&y.throwError("cannot format a constructor for sighash",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"format(sighash)"});let t="constructor("+this.inputs.map(n=>n.format(e)).join(e===m.full?", ":",")+") ";return this.stateMutability&&"nonpayable"!==this.stateMutability&&(t+=this.stateMutability+" "),t.trim()}static from(e){return"string"==typeof e?O.fromString(e):O.fromObject(e)}static fromObject(e){if(O.isConstructorFragment(e))return e;"constructor"!==e.type&&y.throwArgumentError("invalid constructor object","value",e);let t=Y0(e);t.constant&&y.throwArgumentError("constructor cannot be constant","value",e);const n={name:null,type:e.type,inputs:e.inputs?e.inputs.map(x.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?G.O$.from(e.gas):null};return new O(k,n)}static fromString(e){let t={type:"constructor"},n=(e=j0(e,t)).match(K);return(!n||"constructor"!==n[1].trim())&&y.throwArgumentError("invalid constructor string","value",e),t.inputs=W(n[2].trim(),!1),J0(n[3].trim(),t),O.fromObject(t)}static isConstructorFragment(e){return e&&e._isFragment&&"constructor"===e.type}}class B extends O{format(e){if(e||(e=m.sighash),m[e]||y.throwArgumentError("invalid format type","format",e),e===m.json)return JSON.stringify({type:"function",name:this.name,constant:this.constant,stateMutability:"nonpayable"!==this.stateMutability?this.stateMutability:void 0,payable:this.payable,gas:this.gas?this.gas.toNumber():void 0,inputs:this.inputs.map(n=>JSON.parse(n.format(e))),outputs:this.outputs.map(n=>JSON.parse(n.format(e)))});let t="";return e!==m.sighash&&(t+="function "),t+=this.name+"("+this.inputs.map(n=>n.format(e)).join(e===m.full?", ":",")+") ",e!==m.sighash&&(this.stateMutability?"nonpayable"!==this.stateMutability&&(t+=this.stateMutability+" "):this.constant&&(t+="view "),this.outputs&&this.outputs.length&&(t+="returns ("+this.outputs.map(n=>n.format(e)).join(", ")+") "),null!=this.gas&&(t+="@"+this.gas.toString()+" ")),t.trim()}static from(e){return"string"==typeof e?B.fromString(e):B.fromObject(e)}static fromObject(e){if(B.isFunctionFragment(e))return e;"function"!==e.type&&y.throwArgumentError("invalid function object","value",e);let t=Y0(e);const n={type:e.type,name:X(e.name),constant:t.constant,inputs:e.inputs?e.inputs.map(x.fromObject):[],outputs:e.outputs?e.outputs.map(x.fromObject):[],payable:t.payable,stateMutability:t.stateMutability,gas:e.gas?G.O$.from(e.gas):null};return new B(k,n)}static fromString(e){let t={type:"function"},n=(e=j0(e,t)).split(" returns ");n.length>2&&y.throwArgumentError("invalid function string","value",e);let s=n[0].match(K);if(s||y.throwArgumentError("invalid function signature","value",e),t.name=s[1].trim(),t.name&&X(t.name),t.inputs=W(s[2],!1),J0(s[3].trim(),t),n.length>1){let o=n[1].match(K);(""!=o[1].trim()||""!=o[3].trim())&&y.throwArgumentError("unexpected tokens","value",e),t.outputs=W(o[2],!1)}else t.outputs=[];return B.fromObject(t)}static isFunctionFragment(e){return e&&e._isFragment&&"function"===e.type}}function q0(i){const e=i.format();return("Error(string)"===e||"Panic(uint256)"===e)&&y.throwArgumentError(`cannot specify user defined ${e} error`,"fragment",i),i}class U extends F{format(e){if(e||(e=m.sighash),m[e]||y.throwArgumentError("invalid format type","format",e),e===m.json)return JSON.stringify({type:"error",name:this.name,inputs:this.inputs.map(n=>JSON.parse(n.format(e)))});let t="";return e!==m.sighash&&(t+="error "),t+=this.name+"("+this.inputs.map(n=>n.format(e)).join(e===m.full?", ":",")+") ",t.trim()}static from(e){return"string"==typeof e?U.fromString(e):U.fromObject(e)}static fromObject(e){if(U.isErrorFragment(e))return e;"error"!==e.type&&y.throwArgumentError("invalid error object","value",e);const t={type:e.type,name:X(e.name),inputs:e.inputs?e.inputs.map(x.fromObject):[]};return q0(new U(k,t))}static fromString(e){let t={type:"error"},n=e.match(K);return n||y.throwArgumentError("invalid error signature","value",e),t.name=n[1].trim(),t.name&&X(t.name),t.inputs=W(n[2],!1),q0(U.fromObject(t))}static isErrorFragment(e){return e&&e._isFragment&&"error"===e.type}}function J(i){return i.match(/^uint($|[^1-9])/)?i="uint256"+i.substring(4):i.match(/^int($|[^1-9])/)&&(i="int256"+i.substring(3)),i}const Pe=new RegExp("^[a-zA-Z$_][a-zA-Z0-9$_]*$");function X(i){return(!i||!i.match(Pe))&&y.throwArgumentError(`invalid identifier "${i}"`,"value",i),i}const K=new RegExp("^([^)(]*)\\((.*)\\)([^)(]*)$"),e0=new h.Yd(H),Be=new RegExp(/^bytes([0-9]*)$/),Ne=new RegExp(/^(u?int)([0-9]*)$/);class C0{constructor(e){e0.checkNew(new.target,C0),(0,l.zG)(this,"coerceFunc",e||null)}_getCoder(e){switch(e.baseType){case"address":return new ge(e.name);case"bool":return new we(e.name);case"string":return new Ce(e.name);case"bytes":return new Se(e.name);case"array":return new Te(this._getCoder(e.arrayChildren),e.arrayLength,e.name);case"tuple":return new u0((e.components||[]).map(n=>this._getCoder(n)),e.name);case"":return new xe(e.name)}let t=e.type.match(Ne);if(t){let n=parseInt(t[2]||"256");return(0===n||n>256||n%8!=0)&&e0.throwArgumentError("invalid "+t[1]+" bit length","param",e),new Ee(n/8,"int"===t[1],e.name)}if(t=e.type.match(Be),t){let n=parseInt(t[1]);return(0===n||n>32)&&e0.throwArgumentError("invalid bytes length","param",e),new ve(n,e.name)}return e0.throwArgumentError("invalid type","type",e.type)}_getWordSize(){return 32}_getReader(e,t){return new d0(e,this._getWordSize(),this.coerceFunc,t)}_getWriter(){return new E0(this._getWordSize())}getDefaultValue(e){const t=e.map(s=>this._getCoder(x.from(s)));return new u0(t,"_").defaultValue()}encode(e,t){e.length!==t.length&&e0.throwError("types/values length mismatch",h.Yd.errors.INVALID_ARGUMENT,{count:{types:e.length,values:t.length},value:{types:e,values:t}});const n=e.map(a=>this._getCoder(x.from(a))),s=new u0(n,"_"),o=this._getWriter();return s.encode(o,t),o.data}decode(e,t,n){const s=e.map(a=>this._getCoder(x.from(a)));return new u0(s,"_").decode(this._getReader((0,b.lE)(t),n))}}const Me=new C0,w=new h.Yd(H);class $e extends l.dk{}class Ze extends l.dk{}class Fe extends l.dk{}class A0 extends l.dk{static isIndexed(e){return!(!e||!e._isIndexed)}}const Ve={"0x08c379a0":{signature:"Error(string)",name:"Error",inputs:["string"],reason:!0},"0x4e487b71":{signature:"Panic(uint256)",name:"Panic",inputs:["uint256"]}};function Q0(i,e){const t=new Error(`deferred error during ABI decoding triggered accessing ${i}`);return t.error=e,t}class t0{constructor(e){w.checkNew(new.target,t0);let t=[];t="string"==typeof e?JSON.parse(e):e,(0,l.zG)(this,"fragments",t.map(n=>F.from(n)).filter(n=>null!=n)),(0,l.zG)(this,"_abiCoder",(0,l.tu)(new.target,"getAbiCoder")()),(0,l.zG)(this,"functions",{}),(0,l.zG)(this,"errors",{}),(0,l.zG)(this,"events",{}),(0,l.zG)(this,"structs",{}),this.fragments.forEach(n=>{let s=null;switch(n.type){case"constructor":return this.deploy?void w.warn("duplicate definition - constructor"):void(0,l.zG)(this,"deploy",n);case"function":s=this.functions;break;case"event":s=this.events;break;case"error":s=this.errors;break;default:return}let o=n.format();s[o]?w.warn("duplicate definition - "+o):s[o]=n}),this.deploy||(0,l.zG)(this,"deploy",O.from({payable:!1,type:"constructor"})),(0,l.zG)(this,"_isInterface",!0)}format(e){e||(e=m.full),e===m.sighash&&w.throwArgumentError("interface does not support formatting sighash","format",e);const t=this.fragments.map(n=>n.format(e));return e===m.json?JSON.stringify(t.map(n=>JSON.parse(n))):t}static getAbiCoder(){return Me}static getAddress(e){return(0,D.Kn)(e)}static getSighash(e){return(0,b.p3)((0,f0.id)(e.format()),0,4)}static getEventTopic(e){return(0,f0.id)(e.format())}getFunction(e){if((0,b.A7)(e)){for(const n in this.functions)if(e===this.getSighash(n))return this.functions[n];w.throwArgumentError("no matching function","sighash",e)}if(-1===e.indexOf("(")){const n=e.trim(),s=Object.keys(this.functions).filter(o=>o.split("(")[0]===n);return 0===s.length?w.throwArgumentError("no matching function","name",n):s.length>1&&w.throwArgumentError("multiple matching functions","name",n),this.functions[s[0]]}const t=this.functions[B.fromString(e).format()];return t||w.throwArgumentError("no matching function","signature",e),t}getEvent(e){if((0,b.A7)(e)){const n=e.toLowerCase();for(const s in this.events)if(n===this.getEventTopic(s))return this.events[s];w.throwArgumentError("no matching event","topichash",n)}if(-1===e.indexOf("(")){const n=e.trim(),s=Object.keys(this.events).filter(o=>o.split("(")[0]===n);return 0===s.length?w.throwArgumentError("no matching event","name",n):s.length>1&&w.throwArgumentError("multiple matching events","name",n),this.events[s[0]]}const t=this.events[V.fromString(e).format()];return t||w.throwArgumentError("no matching event","signature",e),t}getError(e){if((0,b.A7)(e)){const n=(0,l.tu)(this.constructor,"getSighash");for(const s in this.errors)if(e===n(this.errors[s]))return this.errors[s];w.throwArgumentError("no matching error","sighash",e)}if(-1===e.indexOf("(")){const n=e.trim(),s=Object.keys(this.errors).filter(o=>o.split("(")[0]===n);return 0===s.length?w.throwArgumentError("no matching error","name",n):s.length>1&&w.throwArgumentError("multiple matching errors","name",n),this.errors[s[0]]}const t=this.errors[B.fromString(e).format()];return t||w.throwArgumentError("no matching error","signature",e),t}getSighash(e){if("string"==typeof e)try{e=this.getFunction(e)}catch(t){try{e=this.getError(e)}catch{throw t}}return(0,l.tu)(this.constructor,"getSighash")(e)}getEventTopic(e){return"string"==typeof e&&(e=this.getEvent(e)),(0,l.tu)(this.constructor,"getEventTopic")(e)}_decodeParams(e,t){return this._abiCoder.decode(e,t)}_encodeParams(e,t){return this._abiCoder.encode(e,t)}encodeDeploy(e){return this._encodeParams(this.deploy.inputs,e||[])}decodeErrorResult(e,t){"string"==typeof e&&(e=this.getError(e));const n=(0,b.lE)(t);return(0,b.Dv)(n.slice(0,4))!==this.getSighash(e)&&w.throwArgumentError(`data signature does not match error ${e.name}.`,"data",(0,b.Dv)(n)),this._decodeParams(e.inputs,n.slice(4))}encodeErrorResult(e,t){return"string"==typeof e&&(e=this.getError(e)),(0,b.Dv)((0,b.zo)([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionData(e,t){"string"==typeof e&&(e=this.getFunction(e));const n=(0,b.lE)(t);return(0,b.Dv)(n.slice(0,4))!==this.getSighash(e)&&w.throwArgumentError(`data signature does not match function ${e.name}.`,"data",(0,b.Dv)(n)),this._decodeParams(e.inputs,n.slice(4))}encodeFunctionData(e,t){return"string"==typeof e&&(e=this.getFunction(e)),(0,b.Dv)((0,b.zo)([this.getSighash(e),this._encodeParams(e.inputs,t||[])]))}decodeFunctionResult(e,t){"string"==typeof e&&(e=this.getFunction(e));let n=(0,b.lE)(t),s=null,o="",a=null,c=null,f=null;switch(n.length%this._abiCoder._getWordSize()){case 0:try{return this._abiCoder.decode(e.outputs,n)}catch{}break;case 4:{const d=(0,b.Dv)(n.slice(0,4)),u=Ve[d];if(u)a=this._abiCoder.decode(u.inputs,n.slice(4)),c=u.name,f=u.signature,u.reason&&(s=a[0]),"Error"===c?o=`; VM Exception while processing transaction: reverted with reason string ${JSON.stringify(a[0])}`:"Panic"===c&&(o=`; VM Exception while processing transaction: reverted with panic code ${a[0]}`);else try{const p=this.getError(d);a=this._abiCoder.decode(p.inputs,n.slice(4)),c=p.name,f=p.format()}catch{}break}}return w.throwError("call revert exception"+o,h.Yd.errors.CALL_EXCEPTION,{method:e.format(),data:(0,b.Dv)(t),errorArgs:a,errorName:c,errorSignature:f,reason:s})}encodeFunctionResult(e,t){return"string"==typeof e&&(e=this.getFunction(e)),(0,b.Dv)(this._abiCoder.encode(e.outputs,t||[]))}encodeFilterTopics(e,t){"string"==typeof e&&(e=this.getEvent(e)),t.length>e.inputs.length&&w.throwError("too many arguments for "+e.format(),h.Yd.errors.UNEXPECTED_ARGUMENT,{argument:"values",value:t});let n=[];e.anonymous||n.push(this.getEventTopic(e));const s=(o,a)=>"string"===o.type?(0,f0.id)(a):"bytes"===o.type?(0,z0.w)((0,b.Dv)(a)):("address"===o.type&&this._abiCoder.encode(["address"],[a]),(0,b.$m)((0,b.Dv)(a),32));for(t.forEach((o,a)=>{let c=e.inputs[a];c.indexed?null==o?n.push(null):"array"===c.baseType||"tuple"===c.baseType?w.throwArgumentError("filtering with tuples or arrays not supported","contract."+c.name,o):Array.isArray(o)?n.push(o.map(f=>s(c,f))):n.push(s(c,o)):null!=o&&w.throwArgumentError("cannot filter non-indexed parameters; must be null","contract."+c.name,o)});n.length&&null===n[n.length-1];)n.pop();return n}encodeEventLog(e,t){"string"==typeof e&&(e=this.getEvent(e));const n=[],s=[],o=[];return e.anonymous||n.push(this.getEventTopic(e)),t.length!==e.inputs.length&&w.throwArgumentError("event arguments/values mismatch","values",t),e.inputs.forEach((a,c)=>{const f=t[c];if(a.indexed)if("string"===a.type)n.push((0,f0.id)(f));else if("bytes"===a.type)n.push((0,z0.w)(f));else{if("tuple"===a.baseType||"array"===a.baseType)throw new Error("not implemented");n.push(this._abiCoder.encode([a.type],[f]))}else s.push(a),o.push(f)}),{data:this._abiCoder.encode(s,o),topics:n}}decodeEventLog(e,t,n){if("string"==typeof e&&(e=this.getEvent(e)),null!=n&&!e.anonymous){let g=this.getEventTopic(e);(!(0,b.A7)(n[0],32)||n[0].toLowerCase()!==g)&&w.throwError("fragment/topic mismatch",h.Yd.errors.INVALID_ARGUMENT,{argument:"topics[0]",expected:g,value:n[0]}),n=n.slice(1)}let s=[],o=[],a=[];e.inputs.forEach((g,A)=>{g.indexed?"string"===g.type||"bytes"===g.type||"tuple"===g.baseType||"array"===g.baseType?(s.push(x.fromObject({type:"bytes32",name:g.name})),a.push(!0)):(s.push(g),a.push(!1)):(o.push(g),a.push(!1))});let c=null!=n?this._abiCoder.decode(s,(0,b.zo)(n)):null,f=this._abiCoder.decode(o,t,!0),d=[],u=0,p=0;e.inputs.forEach((g,A)=>{if(g.indexed)if(null==c)d[A]=new A0({_isIndexed:!0,hash:null});else if(a[A])d[A]=new A0({_isIndexed:!0,hash:c[p++]});else try{d[A]=c[p++]}catch(P){d[A]=P}else try{d[A]=f[u++]}catch(P){d[A]=P}if(g.name&&null==d[g.name]){const P=d[A];P instanceof Error?Object.defineProperty(d,g.name,{enumerable:!0,get:()=>{throw Q0(`property ${JSON.stringify(g.name)}`,P)}}):d[g.name]=P}});for(let g=0;g<d.length;g++){const A=d[g];A instanceof Error&&Object.defineProperty(d,g,{enumerable:!0,get:()=>{throw Q0(`index ${g}`,A)}})}return Object.freeze(d)}parseTransaction(e){let t=this.getFunction(e.data.substring(0,10).toLowerCase());return t?new Ze({args:this._abiCoder.decode(t.inputs,"0x"+e.data.substring(10)),functionFragment:t,name:t.name,signature:t.format(),sighash:this.getSighash(t),value:G.O$.from(e.value||"0")}):null}parseLog(e){let t=this.getEvent(e.topics[0]);return!t||t.anonymous?null:new $e({eventFragment:t,name:t.name,signature:t.format(),topic:this.getEventTopic(t),args:this.decodeEventLog(t,e.data,e.topics)})}parseError(e){const t=(0,b.Dv)(e);let n=this.getError(t.substring(0,10).toLowerCase());return n?new Fe({args:this._abiCoder.decode(n.inputs,"0x"+t.substring(10)),errorFragment:n,name:n.name,signature:n.format(),sighash:this.getSighash(n)}):null}static isInterface(e){return!(!e||!e._isInterface)}}var ze=_(2523),G0=_(1979),De=_(896),L=function(i,e,t,n){return new(t||(t=Promise))(function(o,a){function c(u){try{d(n.next(u))}catch(p){a(p)}}function f(u){try{d(n.throw(u))}catch(p){a(p)}}function d(u){u.done?o(u.value):function s(o){return o instanceof t?o:new t(function(a){a(o)})}(u.value).then(c,f)}d((n=n.apply(i,e||[])).next())})};const T=new h.Yd("contracts/5.6.0"),Le={chainId:!0,data:!0,from:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0,customData:!0,ccipReadEnabled:!0};function h0(i,e){return L(this,void 0,void 0,function*(){const t=yield e;"string"!=typeof t&&T.throwArgumentError("invalid address or ENS name","name",t);try{return(0,D.Kn)(t)}catch{}i||T.throwError("a provider or signer is needed to resolve ENS names",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"resolveName"});const n=yield i.resolveName(t);return null==n&&T.throwArgumentError("resolver or addr is not configured for ENS name","name",t),n})}function n0(i,e,t){return L(this,void 0,void 0,function*(){return Array.isArray(t)?yield Promise.all(t.map((n,s)=>n0(i,Array.isArray(e)?e[s]:e[n.name],n))):"address"===t.type?yield h0(i,e):"tuple"===t.type?yield n0(i,e,t.components):"array"===t.baseType?Array.isArray(e)?yield Promise.all(e.map(n=>n0(i,n,t.arrayChildren))):Promise.reject(T.makeError("invalid value for array",h.Yd.errors.INVALID_ARGUMENT,{argument:"value",value:e})):e})}function y0(i,e,t){return L(this,void 0,void 0,function*(){let n={};t.length===e.inputs.length+1&&"object"==typeof t[t.length-1]&&(n=(0,l.DC)(t.pop())),T.checkArgumentCount(t.length,e.inputs.length,"passed to contract"),i.signer?n.from=n.from?(0,l.mE)({override:h0(i.signer,n.from),signer:i.signer.getAddress()}).then(d=>L(this,void 0,void 0,function*(){return(0,D.Kn)(d.signer)!==d.override&&T.throwError("Contract with a Signer cannot override from",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides.from"}),d.override})):i.signer.getAddress():n.from&&(n.from=h0(i.provider,n.from));const s=yield(0,l.mE)({args:n0(i.signer||i.provider,t,e.inputs),address:i.resolvedAddress,overrides:(0,l.mE)(n)||{}}),o=i.interface.encodeFunctionData(e,s.args),a={data:o,to:s.address},c=s.overrides;if(null!=c.nonce&&(a.nonce=G.O$.from(c.nonce).toNumber()),null!=c.gasLimit&&(a.gasLimit=G.O$.from(c.gasLimit)),null!=c.gasPrice&&(a.gasPrice=G.O$.from(c.gasPrice)),null!=c.maxFeePerGas&&(a.maxFeePerGas=G.O$.from(c.maxFeePerGas)),null!=c.maxPriorityFeePerGas&&(a.maxPriorityFeePerGas=G.O$.from(c.maxPriorityFeePerGas)),null!=c.from&&(a.from=c.from),null!=c.type&&(a.type=c.type),null!=c.accessList&&(a.accessList=(0,De.z7)(c.accessList)),null==a.gasLimit&&null!=e.gas){let d=21e3;const u=(0,b.lE)(o);for(let p=0;p<u.length;p++)d+=4,u[p]&&(d+=64);a.gasLimit=G.O$.from(e.gas).add(d)}if(c.value){const d=G.O$.from(c.value);!d.isZero()&&!e.payable&&T.throwError("non-payable method cannot override value",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:n.value}),a.value=d}c.customData&&(a.customData=(0,l.DC)(c.customData)),c.ccipReadEnabled&&(a.ccipReadEnabled=!!c.ccipReadEnabled),delete n.nonce,delete n.gasLimit,delete n.gasPrice,delete n.from,delete n.value,delete n.type,delete n.accessList,delete n.maxFeePerGas,delete n.maxPriorityFeePerGas,delete n.customData,delete n.ccipReadEnabled;const f=Object.keys(n).filter(d=>null!=n[d]);return f.length&&T.throwError(`cannot override ${f.map(d=>JSON.stringify(d)).join(",")}`,h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides",overrides:f}),a})}function H0(i,e){const t=e.wait.bind(e);e.wait=n=>t(n).then(s=>(s.events=s.logs.map(o=>{let a=(0,l.p$)(o),c=null;try{c=i.interface.parseLog(o)}catch{}return c&&(a.args=c.args,a.decode=(f,d)=>i.interface.decodeEventLog(c.eventFragment,f,d),a.event=c.name,a.eventSignature=c.signature),a.removeListener=()=>i.provider,a.getBlock=()=>i.provider.getBlock(s.blockHash),a.getTransaction=()=>i.provider.getTransaction(s.transactionHash),a.getTransactionReceipt=()=>Promise.resolve(s),a}),s))}function W0(i,e,t){const n=i.signer||i.provider;return function(...s){return L(this,void 0,void 0,function*(){let o;if(s.length===e.inputs.length+1&&"object"==typeof s[s.length-1]){const f=(0,l.DC)(s.pop());null!=f.blockTag&&(o=yield f.blockTag),delete f.blockTag,s.push(f)}null!=i.deployTransaction&&(yield i._deployed(o));const a=yield y0(i,e,s),c=yield n.call(a,o);try{let f=i.interface.decodeFunctionResult(e,c);return t&&1===e.outputs.length&&(f=f[0]),f}catch(f){throw f.code===h.Yd.errors.CALL_EXCEPTION&&(f.address=i.address,f.args=s,f.transaction=a),f}})}}function X0(i,e,t){return e.constant?W0(i,e,t):function je(i,e){return function(...t){return L(this,void 0,void 0,function*(){i.signer||T.throwError("sending a transaction requires a signer",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction"}),null!=i.deployTransaction&&(yield i._deployed());const n=yield y0(i,e,t),s=yield i.signer.sendTransaction(n);return H0(i,s),s})}}(i,e)}function K0(i){return!i.address||null!=i.topics&&0!==i.topics.length?(i.address||"*")+"@"+(i.topics?i.topics.map(e=>Array.isArray(e)?e.join("|"):e).join(":"):""):"*"}class r0{constructor(e,t){(0,l.zG)(this,"tag",e),(0,l.zG)(this,"filter",t),this._listeners=[]}addListener(e,t){this._listeners.push({listener:e,once:t})}removeListener(e){let t=!1;this._listeners=this._listeners.filter(n=>!(!t&&n.listener===e&&(t=!0,1)))}removeAllListeners(){this._listeners=[]}listeners(){return this._listeners.map(e=>e.listener)}listenerCount(){return this._listeners.length}run(e){const t=this.listenerCount();return this._listeners=this._listeners.filter(n=>{const s=e.slice();return setTimeout(()=>{n.listener.apply(this,s)},0),!n.once}),t}prepareEvent(e){}getEmit(e){return[e]}}class Je extends r0{constructor(){super("error",null)}}class ee extends r0{constructor(e,t,n,s){const o={address:e};let a=t.getEventTopic(n);s?(a!==s[0]&&T.throwArgumentError("topic mismatch","topics",s),o.topics=s.slice()):o.topics=[a],super(K0(o),o),(0,l.zG)(this,"address",e),(0,l.zG)(this,"interface",t),(0,l.zG)(this,"fragment",n)}prepareEvent(e){super.prepareEvent(e),e.event=this.fragment.name,e.eventSignature=this.fragment.format(),e.decode=(t,n)=>this.interface.decodeEventLog(this.fragment,t,n);try{e.args=this.interface.decodeEventLog(this.fragment,e.data,e.topics)}catch(t){e.args=null,e.decodeError=t}}getEmit(e){const t=function me(i){const e=[],t=function(n,s){if(Array.isArray(s))for(let o in s){const a=n.slice();a.push(o);try{t(a,s[o])}catch(c){e.push({path:a,error:c})}}};return t([],i),e}(e.args);if(t.length)throw t[0].error;const n=(e.args||[]).slice();return n.push(e),n}}class te extends r0{constructor(e,t){super("*",{address:e}),(0,l.zG)(this,"address",e),(0,l.zG)(this,"interface",t)}prepareEvent(e){super.prepareEvent(e);try{const t=this.interface.parseLog(e);e.event=t.name,e.eventSignature=t.signature,e.decode=(n,s)=>this.interface.decodeEventLog(t.eventFragment,n,s),e.args=t.args}catch{}}}class m0 extends class Ye{constructor(e,t,n){T.checkNew(new.target,m0),(0,l.zG)(this,"interface",(0,l.tu)(new.target,"getInterface")(t)),null==n?((0,l.zG)(this,"provider",null),(0,l.zG)(this,"signer",null)):G0.E.isSigner(n)?((0,l.zG)(this,"provider",n.provider||null),(0,l.zG)(this,"signer",n)):ze.zt.isProvider(n)?((0,l.zG)(this,"provider",n),(0,l.zG)(this,"signer",null)):T.throwArgumentError("invalid signer or provider","signerOrProvider",n),(0,l.zG)(this,"callStatic",{}),(0,l.zG)(this,"estimateGas",{}),(0,l.zG)(this,"functions",{}),(0,l.zG)(this,"populateTransaction",{}),(0,l.zG)(this,"filters",{});{const a={};Object.keys(this.interface.events).forEach(c=>{const f=this.interface.events[c];(0,l.zG)(this.filters,c,(...d)=>({address:this.address,topics:this.interface.encodeFilterTopics(f,d)})),a[f.name]||(a[f.name]=[]),a[f.name].push(c)}),Object.keys(a).forEach(c=>{const f=a[c];1===f.length?(0,l.zG)(this.filters,c,this.filters[f[0]]):T.warn(`Duplicate definition of ${c} (${f.join(", ")})`)})}if((0,l.zG)(this,"_runningEvents",{}),(0,l.zG)(this,"_wrappedEmits",{}),null==e&&T.throwArgumentError("invalid contract address or ENS name","addressOrName",e),(0,l.zG)(this,"address",e),this.provider)(0,l.zG)(this,"resolvedAddress",h0(this.provider,e));else try{(0,l.zG)(this,"resolvedAddress",Promise.resolve((0,D.Kn)(e)))}catch{T.throwError("provider is required to use ENS name as contract address",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"new Contract"})}this.resolvedAddress.catch(a=>{});const s={},o={};Object.keys(this.interface.functions).forEach(a=>{const c=this.interface.functions[a];if(o[a])T.warn(`Duplicate ABI entry for ${JSON.stringify(a)}`);else{o[a]=!0;{const f=c.name;s[`%${f}`]||(s[`%${f}`]=[]),s[`%${f}`].push(a)}null==this[a]&&(0,l.zG)(this,a,X0(this,c,!0)),null==this.functions[a]&&(0,l.zG)(this.functions,a,X0(this,c,!1)),null==this.callStatic[a]&&(0,l.zG)(this.callStatic,a,W0(this,c,!0)),null==this.populateTransaction[a]&&(0,l.zG)(this.populateTransaction,a,function ke(i,e){return function(...t){return y0(i,e,t)}}(this,c)),null==this.estimateGas[a]&&(0,l.zG)(this.estimateGas,a,function Re(i,e){const t=i.signer||i.provider;return function(...n){return L(this,void 0,void 0,function*(){t||T.throwError("estimate require a provider or signer",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"estimateGas"});const s=yield y0(i,e,n);return yield t.estimateGas(s)})}}(this,c))}}),Object.keys(s).forEach(a=>{const c=s[a];if(c.length>1)return;a=a.substring(1);const f=c[0];try{null==this[a]&&(0,l.zG)(this,a,this[f])}catch{}null==this.functions[a]&&(0,l.zG)(this.functions,a,this.functions[f]),null==this.callStatic[a]&&(0,l.zG)(this.callStatic,a,this.callStatic[f]),null==this.populateTransaction[a]&&(0,l.zG)(this.populateTransaction,a,this.populateTransaction[f]),null==this.estimateGas[a]&&(0,l.zG)(this.estimateGas,a,this.estimateGas[f])})}static getContractAddress(e){return(0,D.CR)(e)}static getInterface(e){return t0.isInterface(e)?e:new t0(e)}deployed(){return this._deployed()}_deployed(e){return this._deployedPromise||(this._deployedPromise=this.deployTransaction?this.deployTransaction.wait().then(()=>this):this.provider.getCode(this.address,e).then(t=>("0x"===t&&T.throwError("contract not deployed",h.Yd.errors.UNSUPPORTED_OPERATION,{contractAddress:this.address,operation:"getDeployed"}),this))),this._deployedPromise}fallback(e){this.signer||T.throwError("sending a transactions require a signer",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"sendTransaction(fallback)"});const t=(0,l.DC)(e||{});return["from","to"].forEach(function(n){null!=t[n]&&T.throwError("cannot override "+n,h.Yd.errors.UNSUPPORTED_OPERATION,{operation:n})}),t.to=this.resolvedAddress,this.deployed().then(()=>this.signer.sendTransaction(t))}connect(e){"string"==typeof e&&(e=new G0.b(e,this.provider));const t=new this.constructor(this.address,this.interface,e);return this.deployTransaction&&(0,l.zG)(t,"deployTransaction",this.deployTransaction),t}attach(e){return new this.constructor(e,this.interface,this.signer||this.provider)}static isIndexed(e){return A0.isIndexed(e)}_normalizeRunningEvent(e){return this._runningEvents[e.tag]?this._runningEvents[e.tag]:e}_getRunningEvent(e){if("string"==typeof e){if("error"===e)return this._normalizeRunningEvent(new Je);if("event"===e)return this._normalizeRunningEvent(new r0("event",null));if("*"===e)return this._normalizeRunningEvent(new te(this.address,this.interface));const t=this.interface.getEvent(e);return this._normalizeRunningEvent(new ee(this.address,this.interface,t))}if(e.topics&&e.topics.length>0){try{const n=e.topics[0];if("string"!=typeof n)throw new Error("invalid topic");const s=this.interface.getEvent(n);return this._normalizeRunningEvent(new ee(this.address,this.interface,s,e.topics))}catch{}const t={address:this.address,topics:e.topics};return this._normalizeRunningEvent(new r0(K0(t),t))}return this._normalizeRunningEvent(new te(this.address,this.interface))}_checkRunningEvents(e){if(0===e.listenerCount()){delete this._runningEvents[e.tag];const t=this._wrappedEmits[e.tag];t&&e.filter&&(this.provider.off(e.filter,t),delete this._wrappedEmits[e.tag])}}_wrapEvent(e,t,n){const s=(0,l.p$)(t);return s.removeListener=()=>{!n||(e.removeListener(n),this._checkRunningEvents(e))},s.getBlock=()=>this.provider.getBlock(t.blockHash),s.getTransaction=()=>this.provider.getTransaction(t.transactionHash),s.getTransactionReceipt=()=>this.provider.getTransactionReceipt(t.transactionHash),e.prepareEvent(s),s}_addEventListener(e,t,n){if(this.provider||T.throwError("events require a provider or a signer with a provider",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"once"}),e.addListener(t,n),this._runningEvents[e.tag]=e,!this._wrappedEmits[e.tag]){const s=o=>{let a=this._wrapEvent(e,o,t);if(null==a.decodeError)try{const c=e.getEmit(a);this.emit(e.filter,...c)}catch(c){a.decodeError=c.error}null!=e.filter&&this.emit("event",a),null!=a.decodeError&&this.emit("error",a.decodeError,a)};this._wrappedEmits[e.tag]=s,null!=e.filter&&this.provider.on(e.filter,s)}}queryFilter(e,t,n){const s=this._getRunningEvent(e),o=(0,l.DC)(s.filter);return"string"==typeof t&&(0,b.A7)(t,32)?(null!=n&&T.throwArgumentError("cannot specify toBlock with blockhash","toBlock",n),o.blockHash=t):(o.fromBlock=t??0,o.toBlock=n??"latest"),this.provider.getLogs(o).then(a=>a.map(c=>this._wrapEvent(s,c,null)))}on(e,t){return this._addEventListener(this._getRunningEvent(e),t,!1),this}once(e,t){return this._addEventListener(this._getRunningEvent(e),t,!0),this}emit(e,...t){if(!this.provider)return!1;const n=this._getRunningEvent(e),s=n.run(t)>0;return this._checkRunningEvents(n),s}listenerCount(e){return this.provider?null==e?Object.keys(this._runningEvents).reduce((t,n)=>t+this._runningEvents[n].listenerCount(),0):this._getRunningEvent(e).listenerCount():0}listeners(e){if(!this.provider)return[];if(null==e){const t=[];for(let n in this._runningEvents)this._runningEvents[n].listeners().forEach(s=>{t.push(s)});return t}return this._getRunningEvent(e).listeners()}removeAllListeners(e){if(!this.provider)return this;if(null==e){for(const n in this._runningEvents){const s=this._runningEvents[n];s.removeAllListeners(),this._checkRunningEvents(s)}return this}const t=this._getRunningEvent(e);return t.removeAllListeners(),this._checkRunningEvents(t),this}off(e,t){if(!this.provider)return this;const n=this._getRunningEvent(e);return n.removeListener(t),this._checkRunningEvents(n),this}removeListener(e,t){return this.off(e,t)}}{}const g0=[{inputs:[{internalType:"address",name:"_boardSetupVerifier",type:"address"},{internalType:"address",name:"_fireShotVerifier",type:"address"}],stateMutability:"nonpayable",type:"constructor"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_gameId",type:"uint256"},{indexed:!1,internalType:"address",name:"_by",type:"address"}],name:"Joined",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_gameId",type:"uint256"},{indexed:!1,internalType:"uint8",name:"_shotIndex",type:"uint8"}],name:"ShotFired",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_gameId",type:"uint256"},{indexed:!1,internalType:"uint8",name:"_shipId",type:"uint8"}],name:"ShotLanded",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_gameId",type:"uint256"},{indexed:!1,internalType:"address",name:"_by",type:"address"}],name:"Started",type:"event"},{anonymous:!1,inputs:[{indexed:!1,internalType:"uint256",name:"_gameId",type:"uint256"},{indexed:!1,internalType:"address",name:"_by",type:"address"}],name:"Won",type:"event"},{inputs:[],name:"WIN_HIT_COUNT",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[],name:"gameIndex",outputs:[{internalType:"uint256",name:"",type:"uint256"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_gameId",type:"uint256"}],name:"gameState",outputs:[{internalType:"address[2]",name:"_participants",type:"address[2]"},{internalType:"uint256[2]",name:"_boards",type:"uint256[2]"},{internalType:"uint256",name:"_turn",type:"uint256"},{internalType:"uint256[2]",name:"_hits",type:"uint256[2]"},{internalType:"address",name:"_winner",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"",type:"uint256"}],name:"games",outputs:[{internalType:"uint256",name:"turn",type:"uint256"},{internalType:"address",name:"winner",type:"address"}],stateMutability:"view",type:"function"},{inputs:[{internalType:"uint256",name:"_gameId",type:"uint256"},{internalType:"uint256",name:"_boardHash",type:"uint256"},{internalType:"uint256[2]",name:"a",type:"uint256[2]"},{internalType:"uint256[2][2]",name:"b",type:"uint256[2][2]"},{internalType:"uint256[2]",name:"c",type:"uint256[2]"}],name:"joinGame",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_gameId",type:"uint256"},{internalType:"uint256",name:"_turnShotIndex",type:"uint256"}],name:"playFirstTurn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_gameId",type:"uint256"},{internalType:"uint256",name:"_hitShipId",type:"uint256"},{internalType:"uint256",name:"_prevTurnShotIndex",type:"uint256"},{internalType:"uint256",name:"_turnShotIndex",type:"uint256"},{internalType:"uint256[2]",name:"a",type:"uint256[2]"},{internalType:"uint256[2][2]",name:"b",type:"uint256[2][2]"},{internalType:"uint256[2]",name:"c",type:"uint256[2]"}],name:"playTurn",outputs:[],stateMutability:"nonpayable",type:"function"},{inputs:[{internalType:"uint256",name:"_boardHash",type:"uint256"},{internalType:"uint256[2]",name:"a",type:"uint256[2]"},{internalType:"uint256[2][2]",name:"b",type:"uint256[2][2]"},{internalType:"uint256[2]",name:"c",type:"uint256[2]"}],name:"startGame",outputs:[],stateMutability:"nonpayable",type:"function"}],ne="0x608060405234801561001057600080fd5b5060405161111838038061111883398101604081905261002f9161007c565b600280546001600160a01b039384166001600160a01b031991821617909155600380549290931691161790556100af565b80516001600160a01b038116811461007757600080fd5b919050565b6000806040838503121561008f57600080fd5b61009883610060565b91506100a660208401610060565b90509250929050565b61105a806100be6000396000f3fe608060405234801561001057600080fd5b50600436106100885760003560e01c80635654a3411161005b5780635654a34114610131578063763cb3421461013a57806380bdf5d41461014d578063b8ccd40f1461016057600080fd5b8063117a5b901461008d578063498c1b90146100e25780634a11e01f146100f85780634e0e1a3e1461010d575b600080fd5b6100c061009b366004610b7a565b600160205260009081526040902060048101546008909101546001600160a01b031682565b604080519283526001600160a01b039091166020830152015b60405180910390f35b6100ea601181565b6040519081526020016100d9565b61010b610106366004610b93565b610173565b005b61012061011b366004610b7a565b6102d0565b6040516100d9959493929190610bde565b6100ea60005481565b61010b610148366004610d24565b6103b8565b61010b61015b366004610d80565b610546565b61010b61016e366004610def565b610a09565b60008281526001602052604090206004810154156101ce5760405162461bcd60e51b81526020600482015260136024820152724e6f7420746865206669727374207475726e2160681b60448201526064015b60405180910390fd5b80600001546001600160a01b031633146102165760405162461bcd60e51b81526020600482015260096024820152684e6f74207475726e2160b81b60448201526064016101c5565b606482106102665760405162461bcd60e51b815260206004820152601960248201527f53686f7420636f6f7264696e6174657320696e76616c6964210000000000000060448201526064016101c5565b6004810180546000848152600584016020526040812082905590919061028b83610e6c565b90915550506040805184815260ff841660208201527f856b88170e0caeb4b11ef613cb3df1eb1f59ef2c26d3fed6dbd995b325c5ae16910160405180910390a1505050565b6102d8610b5c565b6102e0610b5c565b60006102ea610b5c565b6000858152600160205260408082208151808301928390529091829060029082845b81546001600160a01b0316815260019091019060200180831161030c5750506040805180820191829052949a50600286810194509250905082845b81548152602001906001019080831161034757505050506004830154604080518082019182905293985090965060068401915060029082845b815481526020019060010190808311610380575050506008909301549799969850949690956001600160a01b03909116945092505050565b6000858152600160208190526040822091908201546001600160a01b0316146104185760405162461bcd60e51b815260206004820152601260248201527147616d6520616c72656164792066756c6c2160701b60448201526064016101c5565b6002546040805160208101825287815290516343753b4d60e01b81526001600160a01b03909216916343753b4d916104599188918891889190600401610edd565b602060405180830381865afa158015610476573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061049a9190610f3a565b6104e65760405162461bcd60e51b815260206004820152601b60248201527f496e76616c6964207368697020636f6e66696775726174696f6e21000000000060448201526064016101c5565b6001810180546001600160a01b03191633908117909155600382018690556040805188815260208101929092527fc0081eeafa0d002abcd7d58d84b6e688d1526b9c3d915a282212ba08c49a17a7910160405180910390a1505050505050565b60008781526001602081905260408220600481015490929160029161056b9190610f63565b6105759190610f7a565b905060006002836004015461058a9190610f7a565b905060008360040154116105d25760405162461bcd60e51b815260206004820152600f60248201526e546865206669727374207475726e2160881b60448201526064016101c5565b8281600281106105e4576105e4610e40565b01546001600160a01b031633146106295760405162461bcd60e51b81526020600482015260096024820152684e6f74207475726e2160b81b60448201526064016101c5565b60088301546001600160a01b0316156106795760405162461bcd60e51b815260206004820152601260248201527147616d6520616c7265616479206f7665722160701b60448201526064016101c5565b606487106106c95760405162461bcd60e51b815260206004820152601e60248201527f4e6578742073686f7420636f6f7264696e6174657320696e76616c696421000060448201526064016101c5565b6005830160006106da846064610f9c565b6106e4908b610fbb565b815260200190815260200160002054600184600401546107049190610f63565b1480156107c45750600360009054906101000a90046001600160a01b03166001600160a01b03166311479fea87878760405180606001604052808f815260200189600201896002811061075957610759610e40565b015481526020018e8152506040518563ffffffff1660e01b81526004016107839493929190610fd3565b602060405180830381865afa1580156107a0573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906107c49190610f3a565b6108015760405162461bcd60e51b815260206004820152600e60248201526d496e76616c69642070726f6f662160901b60448201526064016101c5565b88156108315782600601826002811061081c5761081c610e40565b01805490600061082b83610e6c565b91905055505b604080518b815260ff8b1660208201527f8f78455e6cc82b42f8dc866bf3befc9b590f0ad419058f342ccab8f2cf4fcf19910160405180910390a1601183600601836002811061088357610883610e40565b0154106108fd5782826002811061089c5761089c610e40565b01546008840180546001600160a01b0319166001600160a01b039092169182179055604080518c815260208101929092527f34fee8cf8c6f9d389d6b16d4f6676f2d68632f123b5a7c3a4dd48b0ec7fac014910160405180910390a16109fd565b60058301600061090e836064610f9c565b610918908a610fbb565b81526020019081526020016000205460001461096e5760405162461bcd60e51b815260206004820152601560248201527453686f7473206d75737420626520756e697175652160581b60448201526064016101c5565b6004830154600584016000610984846064610f9c565b61098e908b610fbb565b8152602001908152602001600020819055507f856b88170e0caeb4b11ef613cb3df1eb1f59ef2c26d3fed6dbd995b325c5ae168a886040516109dd92919091825260ff16602082015260400190565b60405180910390a16004830180549060006109f783610e6c565b91905055505b50505050505050505050565b6002546040805160208101825286815290516343753b4d60e01b81526001600160a01b03909216916343753b4d91610a4a9187918791879190600401610edd565b602060405180830381865afa158015610a67573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610a8b9190610f3a565b610ad75760405162461bcd60e51b815260206004820152601b60248201527f496e76616c6964207368697020636f6e66696775726174696f6e21000000000060448201526064016101c5565b60008054815260016020908152604080832080546001600160a01b031916339081179091558354845281842060020188905592548151908152918201929092527fcb88c87e28a0e0b68deef72d3d3536c607260b8c80944e6117a896f855eed81f910160405180910390a1600080549080610b5183610e6c565b919050555050505050565b60405180604001604052806002906020820280368337509192915050565b600060208284031215610b8c57600080fd5b5035919050565b60008060408385031215610ba657600080fd5b50508035926020909101359150565b8060005b6002811015610bd8578151845260209384019390910190600101610bb9565b50505050565b6101008101818760005b6002811015610c105781516001600160a01b0316835260209283019290910190600101610be8565b505050610c206040830187610bb5565b846080830152610c3360a0830185610bb5565b6001600160a01b039290921660e09190910152949350505050565b6040805190810167ffffffffffffffff81118282101715610c7f57634e487b7160e01b600052604160045260246000fd5b60405290565b600082601f830112610c9657600080fd5b610c9e610c4e565b806040840185811115610cb057600080fd5b845b81811015610cca578035845260209384019301610cb2565b509095945050505050565b600082601f830112610ce657600080fd5b610cee610c4e565b806080840185811115610d0057600080fd5b845b81811015610cca57610d148782610c85565b8452602090930192604001610d02565b60008060008060006101408688031215610d3d57600080fd5b8535945060208601359350610d558760408801610c85565b9250610d648760808801610cd5565b9150610d74876101008801610c85565b90509295509295909350565b6000806000806000806000610180888a031215610d9c57600080fd5b87359650602088013595506040880135945060608801359350610dc28960808a01610c85565b9250610dd18960c08a01610cd5565b9150610de1896101408a01610c85565b905092959891949750929550565b6000806000806101208587031215610e0657600080fd5b84359350610e178660208701610c85565b9250610e268660608701610cd5565b9150610e358660e08701610c85565b905092959194509250565b634e487b7160e01b600052603260045260246000fd5b634e487b7160e01b600052601160045260246000fd5b600060018201610e7e57610e7e610e56565b5060010190565b806000805b6002808210610e995750610ed6565b835186845b83811015610ebc578251825260209283019290910190600101610e9e565b505050604095909501945060209290920191600101610e8a565b5050505050565b6101208101610eec8287610bb5565b610ef96040830186610e85565b610f0660c0830185610bb5565b61010082018360005b6001811015610f2e578151835260209283019290910190600101610f0f565b50505095945050505050565b600060208284031215610f4c57600080fd5b81518015158114610f5c57600080fd5b9392505050565b600082821015610f7557610f75610e56565b500390565b600082610f9757634e487b7160e01b600052601260045260246000fd5b500690565b6000816000190483118215151615610fb657610fb6610e56565b500290565b60008219821115610fce57610fce610e56565b500190565b6101608101610fe28287610bb5565b610fef6040830186610e85565b610ffc60c0830185610bb5565b61010082018360005b6003811015610f2e57815183526020928301929091019060010161100556fea26469706673582212203cc365a39db3e85ab89e6a48ca9f9b791dc3452fa51f7375bcba8b72e03b639364736f6c634300080d0033";let He=(()=>{class i extends class qe{constructor(e,t,n){let s=null;s="string"==typeof t?t:(0,b._t)(t)?(0,b.Dv)(t):t&&"string"==typeof t.object?t.object:"!","0x"!==s.substring(0,2)&&(s="0x"+s),(!(0,b.A7)(s)||s.length%2)&&T.throwArgumentError("invalid bytecode","bytecode",t),n&&!G0.E.isSigner(n)&&T.throwArgumentError("invalid signer","signer",n),(0,l.zG)(this,"bytecode",s),(0,l.zG)(this,"interface",(0,l.tu)(new.target,"getInterface")(e)),(0,l.zG)(this,"signer",n||null)}getDeployTransaction(...e){let t={};if(e.length===this.interface.deploy.inputs.length+1&&"object"==typeof e[e.length-1]){t=(0,l.DC)(e.pop());for(const n in t)if(!Le[n])throw new Error("unknown transaction override "+n)}return["data","from","to"].forEach(n=>{null!=t[n]&&T.throwError("cannot override "+n,h.Yd.errors.UNSUPPORTED_OPERATION,{operation:n})}),t.value&&!G.O$.from(t.value).isZero()&&!this.interface.deploy.payable&&T.throwError("non-payable constructor cannot override value",h.Yd.errors.UNSUPPORTED_OPERATION,{operation:"overrides.value",value:t.value}),T.checkArgumentCount(e.length,this.interface.deploy.inputs.length," in Contract constructor"),t.data=(0,b.Dv)((0,b.zo)([this.bytecode,this.interface.encodeDeploy(e)])),t}deploy(...e){return L(this,void 0,void 0,function*(){let t={};e.length===this.interface.deploy.inputs.length+1&&(t=e.pop()),T.checkArgumentCount(e.length,this.interface.deploy.inputs.length," in Contract constructor");const n=yield n0(this.signer,e,this.interface.deploy.inputs);n.push(t);const s=this.getDeployTransaction(...n),o=yield this.signer.sendTransaction(s),a=(0,l.tu)(this.constructor,"getContractAddress")(o),c=(0,l.tu)(this.constructor,"getContract")(a,this.interface,this.signer);return H0(c,o),(0,l.zG)(c,"deployTransaction",o),c})}attach(e){return this.constructor.getContract(e,this.interface,this.signer)}connect(e){return new this.constructor(this.interface,this.bytecode,e)}static fromSolidity(e,t){null==e&&T.throwError("missing compiler output",h.Yd.errors.MISSING_ARGUMENT,{argument:"compilerOutput"}),"string"==typeof e&&(e=JSON.parse(e));let s=null;return e.bytecode?s=e.bytecode:e.evm&&e.evm.bytecode&&(s=e.evm.bytecode),new this(e.abi,s,t)}static getInterface(e){return m0.getInterface(e)}static getContractAddress(e){return(0,D.CR)(e)}static getContract(e,t,n){return new m0(e,t,n)}}{constructor(...t){(i=>i.length>1)(t)?super(...t):super(g0,ne,t[0])}deploy(t,n,s){return super.deploy(t,n,s||{})}getDeployTransaction(t,n,s){return super.getDeployTransaction(t,n,s||{})}attach(t){return super.attach(t)}connect(t){return super.connect(t)}static createInterface(){return new t0(g0)}static connect(t,n){return new m0(t,g0,n)}}return i.bytecode=ne,i.abi=g0,i})();var We=_(7935);let I0=(()=>{class i{constructor(t){this.wallet=t,this.gameContract$=this.wallet.signer$.pipe((0,v.U)(n=>He.connect(We.N.gameContractAddress,n)),(0,E.d)(1))}startGame({boardHash:t,pi_a:n,pi_b:s,pi_c:o}){var a=this;return(0,I.Z)(function*(){const d=(yield(yield C(a.gameContract$)).startGame(t,n,s,o).then(u=>u.wait(1))).events?.find(u=>"Started"===u.event);if(!d)throw Error("Game started event not found!");return d.args._gameId.toBigInt()})()}joinGame(t,{boardHash:n,pi_a:s,pi_b:o,pi_c:a}){var c=this;return(0,I.Z)(function*(){yield(yield C(c.gameContract$)).joinGame(t,n,s,o,a).then(d=>d.wait(1))})()}playFirstTurn(t,n){var s=this;return(0,I.Z)(function*(){yield(yield C(s.gameContract$)).playFirstTurn(t,n).then(a=>a.wait(1))})()}playTurn(t,n,s,{hitShipId:o,pi_a:a,pi_b:c,pi_c:f}){var d=this;return(0,I.Z)(function*(){yield(yield C(d.gameContract$)).playTurn(t,o,n,s,a,c,f).then(p=>p.wait(1))})()}}return i.\u0275fac=function(t){return new(t||i)(r.LFG(o0.X))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),P0=(()=>{class i{constructor(t){this.storage=t.defaultView.localStorage}getGameBoard(t,n){var s=this;return(0,I.Z)(function*(){const o=s.storage.getItem(`${t} - ${n}`);if(o)return s.deserializeBoard(o)})()}storeGameBoard(t,n,s){var o=this;return(0,I.Z)(function*(){o.storage.setItem(`${t} - ${n}`,o.serializeBoard(s))})()}serializeBoard({ships:t,trapdoor:n,hash:s}){const o={ships:t.map(a=>a.map(c=>c.toString())),trapdoor:n.toString(),hash:s.toString()};return JSON.stringify(o)}deserializeBoard(t){const n=JSON.parse(t);return{ships:n.ships.map(s=>s.map(o=>BigInt(o))),trapdoor:BigInt(n.trapdoor),hash:BigInt(n.hash)}}}return i.\u0275fac=function(t){return new(t||i)(r.LFG(S.K0))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})(),Xe=(()=>{class i{constructor(t,n,s,o,a){this.wallet=t,this.gameProver=n,this.gameContract=s,this.gameStorage=o,this.router=a,this.playerCreatingGame$=new a0.X(!1)}ngOnInit(){}createGame(){var t=this;return(0,I.Z)(function*(){if(!(yield C(t.playerCreatingGame$))){t.playerCreatingGame$.next(!0);try{const s=yield C(t.wallet.address$),o=yield C(t.fleetSetupBoard.fleetConfiguration$).then(d=>d),a=V0(),c=yield t.gameProver.generateBoardSetupProof(o,a),f=yield t.gameContract.startGame(c);yield t.gameStorage.storeGameBoard(f,s,{ships:o,trapdoor:a,hash:c.boardHash}),yield t.router.navigate(["games",f,"play"])}finally{t.playerCreatingGame$.next(!1)}}})()}}return i.\u0275fac=function(t){return new(t||i)(r.Y36(o0.X),r.Y36(v0),r.Y36(I0),r.Y36(P0),r.Y36(M.F0))},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-game-create"]],viewQuery:function(t,n){if(1&t&&r.Gf(s0,7),2&t){let s;r.iGM(s=r.CRH())&&(n.fleetSetupBoard=s.first)}},decls:15,vars:7,consts:[[1,"text-center"],[1,"btn","btn-primary",3,"disabled","click"],[1,"position-fixed","bottom-0","end-0","p-3",2,"z-index","11"],["id","liveToast","role","alert","aria-live","assertive","aria-atomic","true",1,"toast"],[1,"toast-header"],[1,"me-auto"],[1,"toast-body"]],template:function(t,n){1&t&&(r.TgZ(0,"h1",0),r._uU(1,"Deploy your fleet!"),r.qZA(),r._UZ(2,"app-fleet-setup-board"),r.TgZ(3,"div",0)(4,"button",1),r.NdJ("click",function(){return n.createGame()}),r.ALo(5,"async"),r._uU(6," Create game "),r.qZA()(),r.TgZ(7,"div",2)(8,"div",3),r.ALo(9,"async"),r.TgZ(10,"div",4)(11,"strong",5),r._uU(12,"Battleship3"),r.qZA()(),r.TgZ(13,"div",6),r._uU(14,"Creating game..."),r.qZA()()()),2&t&&(r.xp6(4),r.Q6J("disabled",!r.lcZ(5,3,n.fleetSetupBoard.fleetComplete$)),r.xp6(4),r.ekj("show",r.lcZ(9,5,n.playerCreatingGame$)))},directives:[s0],pipes:[S.Ov],styles:[""]}),i})(),Ke=(()=>{class i{constructor(t,n,s,o,a,c){this.wallet=t,this.gameProver=n,this.gameContract=s,this.gameStorage=o,this.route=a,this.router=c,this.gameId$=this.route.paramMap.pipe((0,v.U)(f=>BigInt(f.get("gameId"))),(0,E.d)(1)),this.playerJoiningGame$=new a0.X(!1)}ngOnInit(){}joinGame(){var t=this;return(0,I.Z)(function*(){if(!(yield C(t.playerJoiningGame$))){t.playerJoiningGame$.next(!0);try{const s=yield C(t.wallet.address$),o=yield C(t.fleetSetupBoard.fleetConfiguration$).then(d=>d),a=V0(),c=yield t.gameProver.generateBoardSetupProof(o,a),f=yield C(t.gameId$);yield t.gameContract.joinGame(f,c),yield t.gameStorage.storeGameBoard(f,s,{ships:o,trapdoor:a,hash:c.boardHash}),yield t.router.navigate(["games",f,"play"])}finally{t.playerJoiningGame$.next(!1)}}})()}}return i.\u0275fac=function(t){return new(t||i)(r.Y36(o0.X),r.Y36(v0),r.Y36(I0),r.Y36(P0),r.Y36(M.gz),r.Y36(M.F0))},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-game-join"]],viewQuery:function(t,n){if(1&t&&r.Gf(s0,7),2&t){let s;r.iGM(s=r.CRH())&&(n.fleetSetupBoard=s.first)}},decls:15,vars:7,consts:[[1,"text-center"],[1,"btn","btn-primary",3,"disabled","click"],[1,"position-fixed","bottom-0","end-0","p-3",2,"z-index","11"],["id","liveToast","role","alert","aria-live","assertive","aria-atomic","true",1,"toast"],[1,"toast-header"],[1,"me-auto"],[1,"toast-body"]],template:function(t,n){1&t&&(r.TgZ(0,"h1",0),r._uU(1,"Deploy your fleet!"),r.qZA(),r._UZ(2,"app-fleet-setup-board"),r.TgZ(3,"div",0)(4,"button",1),r.NdJ("click",function(){return n.joinGame()}),r.ALo(5,"async"),r._uU(6," Join game "),r.qZA()(),r.TgZ(7,"div",2)(8,"div",3),r.ALo(9,"async"),r.TgZ(10,"div",4)(11,"strong",5),r._uU(12,"Battleship3"),r.qZA()(),r.TgZ(13,"div",6),r._uU(14,"Joining game..."),r.qZA()()()),2&t&&(r.xp6(4),r.Q6J("disabled",!r.lcZ(5,3,n.fleetSetupBoard.fleetComplete$)),r.xp6(4),r.ekj("show",r.lcZ(9,5,n.playerJoiningGame$)))},directives:[s0],pipes:[S.Ov],styles:[""]}),i})();var re=_(1063),et=_(833),Y=_(2862),R=_(5554),q=(()=>{return(i=q||(q={})).Joined="JOINED",i.Over="OVER",i.Started="STARTED",q;var i})(),Q=(()=>{return(i=Q||(Q={})).Battleship="BATTLESHIP",i.Carrier="CARRIER",i.Cruiser="CRUISER",i.Destroyer="DESTROYER",i.Miss="MISS",i.Submarine="SUBMARINE",i.Unknown="UNKNOWN",Q;var i})();R.Ps`
    query GameJoin($gameId: ID!) {
  game(id: $gameId) {
    id
    status
    startedBy
  }
}
    `;const tt=R.Ps`
    query GamePlay($gameId: ID!) {
  game(id: $gameId) {
    id
    status
    turn
    startedBy
    joinedBy
    wonBy
    shots(orderBy: turn, orderDirection: asc) {
      id
      status
      turn
      x
      y
    }
  }
}
    `;let nt=(()=>{class i extends R.AE{constructor(t){super(t),this.document=tt}}return i.\u0275fac=function(t){return new(t||i)(r.LFG(R._M))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();const rt=R.Ps`
    query StartedGames {
  games(where: {status: STARTED}) {
    id
    startedBy
  }
}
    `;let it=(()=>{class i extends R.AE{constructor(t){super(t),this.document=rt}}return i.\u0275fac=function(t){return new(t||i)(r.LFG(R._M))},i.\u0275prov=r.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function at(i,e){1&i&&(r.TgZ(0,"h1",9),r._uU(1," Waiting for opponent... "),r.qZA())}function st(i,e){1&i&&(r.TgZ(0,"h1",9),r._uU(1,"Your turn!"),r.qZA())}function ot(i,e){1&i&&(r.TgZ(0,"h1",9),r._uU(1," Waiting for opponent turn... "),r.qZA())}function ct(i,e){1&i&&(r.TgZ(0,"h1",9),r._uU(1,"You won!"),r.qZA())}function dt(i,e){1&i&&(r.TgZ(0,"h1",9),r._uU(1,"You lost!"),r.qZA())}function ft(i,e){if(1&i&&(r.TgZ(0,"th"),r._uU(1),r.qZA()),2&i){const t=e.$implicit;r.xp6(1),r.Oqu(t)}}function lt(i,e){if(1&i&&(r.TgZ(0,"span"),r._uU(1),r.qZA()),2&i){const t=r.oxw().ngIf;r.xp6(1),r.hij(" ",t.ship.id," ")}}function ut(i,e){if(1&i&&(r.TgZ(0,"td"),r.YNc(1,lt,2,1,"span",7),r.qZA()),2&i){const t=e.ngIf;r.ekj("shot-miss",t.present&&!t.ship)("shot-hit",t.present&&t.ship),r.xp6(1),r.Q6J("ngIf",t.ship)}}const bt=function(i,e){return{present:i,ship:e}};function pt(i,e){if(1&i&&(r.ynx(0),r.YNc(1,ut,2,5,"td",19),r.BQk()),2&i){const t=e.index,n=r.oxw().index,s=r.oxw().ngIf,o=r.oxw().ngIf;r.xp6(1),r.Q6J("ngIf",r.WLB(1,bt,!!s[t][n],o[t][n]))}}function ht(i,e){if(1&i&&(r.TgZ(0,"tr")(1,"th"),r._uU(2),r.qZA(),r.YNc(3,pt,2,4,"ng-container",18),r.qZA()),2&i){const t=e.$implicit,n=r.oxw(3);r.xp6(2),r.Oqu(t),r.xp6(1),r.Q6J("ngForOf",n.columns)}}function yt(i,e){if(1&i&&(r.TgZ(0,"table",17)(1,"tr"),r._UZ(2,"th"),r.YNc(3,ft,2,1,"th",18),r.qZA(),r.YNc(4,ht,4,2,"tr",18),r.qZA()),2&i){const t=r.oxw(2);r.xp6(3),r.Q6J("ngForOf",t.columns),r.xp6(1),r.Q6J("ngForOf",t.rows)}}function mt(i,e){if(1&i&&(r.ynx(0),r.YNc(1,yt,5,2,"table",16),r.ALo(2,"async"),r.BQk()),2&i){const t=r.oxw();r.xp6(1),r.Q6J("ngIf",r.lcZ(2,1,t.opponentShotsBoard$))}}function gt(i,e){if(1&i&&(r.TgZ(0,"th"),r._uU(1),r.qZA()),2&i){const t=e.$implicit;r.xp6(1),r.Oqu(t)}}function _t(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"U"),r.qZA())}function Tt(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"M"),r.qZA())}function wt(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"CA"),r.qZA())}function St(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"B"),r.qZA())}function vt(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"CR"),r.qZA())}function xt(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"S"),r.qZA())}function Et(i,e){1&i&&(r.TgZ(0,"span"),r._uU(1,"D"),r.qZA())}function Ct(i,e){if(1&i&&(r.TgZ(0,"td",23),r.YNc(1,_t,2,0,"span",24),r.YNc(2,Tt,2,0,"span",24),r.YNc(3,wt,2,0,"span",24),r.YNc(4,St,2,0,"span",24),r.YNc(5,vt,2,0,"span",24),r.YNc(6,xt,2,0,"span",24),r.YNc(7,Et,2,0,"span",24),r.qZA()),2&i){const t=e.ngIf,n=r.oxw(4);r.ekj("shot-miss",t.status===n.ShotStatus.Miss)("shot-hit",t.status!==n.ShotStatus.Unknown&&t.status!==n.ShotStatus.Miss),r.Q6J("ngSwitch",t.status),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Unknown),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Miss),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Carrier),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Battleship),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Cruiser),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Submarine),r.xp6(1),r.Q6J("ngSwitchCase",n.ShotStatus.Destroyer)}}function At(i,e){if(1&i){const t=r.EpF();r.TgZ(0,"td",25),r.NdJ("click",function(){r.CHM(t);const s=r.oxw().index,o=r.oxw().index;return r.oxw(2).selectPlayerTurnShotLocation(s,o)}),r.qZA()}if(2&i){const t=r.oxw().index,n=r.oxw().index,s=r.oxw(2);r.ekj("selected",s.playerShotLocationIsSelected(t,n))}}function Gt(i,e){if(1&i&&(r.ynx(0),r.YNc(1,Ct,8,12,"td",21),r.YNc(2,At,1,2,"ng-template",null,22,r.W1O),r.BQk()),2&i){const t=e.index,n=r.MAs(3),s=r.oxw().index,o=r.oxw().ngIf;r.xp6(1),r.Q6J("ngIf",o[t][s])("ngIfElse",n)}}function It(i,e){if(1&i&&(r.TgZ(0,"tr")(1,"th"),r._uU(2),r.qZA(),r.YNc(3,Gt,4,2,"ng-container",18),r.qZA()),2&i){const t=e.$implicit,n=r.oxw(2);r.xp6(2),r.Oqu(t),r.xp6(1),r.Q6J("ngForOf",n.columns)}}function Pt(i,e){if(1&i&&(r.TgZ(0,"table",20)(1,"tr"),r._UZ(2,"th"),r.YNc(3,gt,2,1,"th",18),r.qZA(),r.YNc(4,It,4,2,"tr",18),r.qZA()),2&i){const t=r.oxw();r.xp6(3),r.Q6J("ngForOf",t.columns),r.xp6(1),r.Q6J("ngForOf",t.rows)}}var N=(()=>{return(i=N||(N={}))[i.WaitingForOpponent=0]="WaitingForOpponent",i[i.PlayerTurn=1]="PlayerTurn",i[i.OpponentTurn=2]="OpponentTurn",i[i.PlayerWon=3]="PlayerWon",i[i.PlayerLost=4]="PlayerLost",N;var i})();const ie=i=>i.status!==Q.Miss&&i.status!==Q.Unknown;function ae(i){const e=[];for(let t=0;t<10;t++)e.push(new Array(10));for(const t of i)e[t.x][t.y]=t;return e}function O0(i,e){return BigInt(i+e*z)}let Ot=(()=>{class i{constructor(t,n,s,o,a,c,f){this.wallet=t,this.gamePlayGql=n,this.gameProver=s,this.gameContract=o,this.gameStorage=a,this.route=c,this.router=f,this.TurnStatus=N,this.ShotStatus=Q,this.gameId$=this.route.paramMap.pipe((0,v.U)(d=>d.get("gameId")),(0,E.d)(1)),this.game$=this.gameId$.pipe((0,re.w)(d=>this.gamePlayGql.watch({gameId:d},{pollInterval:1e3}).valueChanges),(0,v.U)(({data:d})=>d?.game),(0,et.h)(d=>!!d),(0,E.d)(1)),this.isHost$=(0,Y.a)([this.wallet.address$,this.game$]).pipe((0,v.U)(([d,u])=>u.startedBy.toLowerCase()===d?.toLowerCase()),(0,E.d)(1)),this.turnStatus$=(0,Y.a)([this.wallet.address$,this.game$,this.isHost$]).pipe((0,v.U)(([d,u,p])=>{switch(u.status){case q.Started:return N.WaitingForOpponent;case q.Joined:return u.turn%2==(p?0:1)?N.PlayerTurn:N.OpponentTurn;case q.Over:return u.wonBy.toLowerCase()===d?.toLowerCase()?N.PlayerWon:N.PlayerLost;default:throw new Error("Invalid game status!")}}),(0,E.d)(1)),this.isPlayerTurn$=this.turnStatus$.pipe((0,v.U)(d=>d===N.PlayerTurn),(0,E.d)(1)),this.playerBoard$=(0,Y.a)([this.gameId$,this.wallet.address$]).pipe((0,re.w)(([d,u])=>this.gameStorage.getGameBoard(BigInt(d),u)),(0,E.d)(1)),this.playerShipOccupancyBoard$=this.playerBoard$.pipe((0,v.U)(d=>{const u=[];for(let p=0;p<z;p++)u.push(new Array(z).fill(void 0));if(!d)return u;for(let p=0;p<5;p++){const g=d.ships[p],A=S0[p].length,P=Number(g[0]),B0=Number(g[1]),T0=0n===g[2],Rt=(T0?P:B0)+A-1;for(let w0=T0?P:B0;w0<Rt+1;w0++)u[T0?w0:P][T0?B0:w0]=S0[p]}return u})),this.playerFiringShot$=new a0.X(!1),this.playerShots$=(0,Y.a)([this.game$,this.isHost$]).pipe((0,v.U)(([d,u])=>d.shots?.filter(p=>p.turn%2==(u?0:1))||[]),(0,E.d)(1)),this.opponentShots$=(0,Y.a)([this.game$,this.isHost$]).pipe((0,v.U)(([d,u])=>d.shots?.filter(p=>p.turn%2==(u?1:0))||[]),(0,E.d)(1)),this.playerHitShots$=this.playerShots$.pipe((0,v.U)(d=>d?.filter(ie)),(0,E.d)(1)),this.opponentHitShots$=this.opponentShots$.pipe((0,v.U)(d=>d?.filter(ie)),(0,E.d)(1)),this.playerShotsBoard$=this.playerShots$.pipe((0,v.U)(ae),(0,E.d)(1)),this.opponentShotsBoard$=this.opponentShots$.pipe((0,v.U)(ae),(0,E.d)(1)),this.playerCellsLeft$=this.opponentHitShots$.pipe((0,v.U)(d=>17-d?.length),(0,E.d)(1)),this.opponentCellsLeft$=this.playerHitShots$.pipe((0,v.U)(d=>17-d?.length),(0,E.d)(1)),this.lastGameShot$=this.game$.pipe((0,v.U)(d=>d.shots&&d.shots.length>0?d.shots[d.shots.length-1]:void 0),(0,E.d)(1)),this.playerShotSelection=new M0,this.playerCanFireShot$=(0,Y.a)([this.isPlayerTurn$,this.playerShotSelection.changed.asObservable()]).pipe((0,v.U)(([d,u])=>d&&u.source.hasValue())),this.columns=$0,this.rows=Z0}ngOnInit(){}fireShot(){var t=this;return(0,I.Z)(function*(){if(!(yield C(t.playerFiringShot$))){t.playerFiringShot$.next(!0);try{const s=yield C(t.game$).then(c=>0===c?.turn),o=yield C(t.gameId$).then(c=>BigInt(c)),a=t.playerShotSelection.selected[0];if(s)yield t.gameContract.playFirstTurn(o,a);else{const c=yield C(t.playerBoard$).then(p=>p),f=yield C(t.lastGameShot$).then(p=>p),d=O0(f.x,f.y),u=yield t.gameProver.generateFireShotProof(c.ships,c.trapdoor,c.hash,d);yield t.gameContract.playTurn(o,d,a,u)}t.playerShotSelection.clear()}finally{t.playerFiringShot$.next(!1)}}})()}selectPlayerTurnShotLocation(t,n){this.playerShotSelection.toggle(O0(t,n))}playerShotLocationIsSelected(t,n){return this.playerShotSelection.isSelected(O0(t,n))}}return i.\u0275fac=function(t){return new(t||i)(r.Y36(o0.X),r.Y36(nt),r.Y36(v0),r.Y36(I0),r.Y36(P0),r.Y36(M.gz),r.Y36(M.F0))},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-game-play"]],decls:37,vars:27,consts:[[3,"ngSwitch"],["class","text-center",4,"ngSwitchCase"],[1,"d-flex","justify-content-between"],[1,"h5","mb-1"],[1,"h4"],[1,"text-end"],[1,"d-flex","justify-content-center"],[4,"ngIf"],["id","player-shots-board","class","flex-1 m-5",4,"ngIf"],[1,"text-center"],[1,"btn","btn-primary",3,"disabled","click"],[1,"position-fixed","bottom-0","end-0","p-3",2,"z-index","11"],["id","liveToast","role","alert","aria-live","assertive","aria-atomic","true",1,"toast"],[1,"toast-header"],[1,"me-auto"],[1,"toast-body"],["id","player-ships-board","class","flex-1 m-5",4,"ngIf"],["id","player-ships-board",1,"flex-1","m-5"],[4,"ngFor","ngForOf"],[3,"shot-miss","shot-hit",4,"ngIf"],["id","player-shots-board",1,"flex-1","m-5"],["class","shot-present",3,"shot-miss","shot-hit","ngSwitch",4,"ngIf","ngIfElse"],["noPlayerShotCell",""],[1,"shot-present",3,"ngSwitch"],[4,"ngSwitchCase"],[3,"click"]],template:function(t,n){1&t&&(r.ynx(0,0),r.ALo(1,"async"),r.YNc(2,at,2,0,"h1",1),r.YNc(3,st,2,0,"h1",1),r.YNc(4,ot,2,0,"h1",1),r.YNc(5,ct,2,0,"h1",1),r.YNc(6,dt,2,0,"h1",1),r.BQk(),r.TgZ(7,"div",2)(8,"div")(9,"p",3),r._uU(10,"Your Ship Cells Left"),r.qZA(),r.TgZ(11,"p",4),r._uU(12),r.ALo(13,"async"),r.qZA()(),r.TgZ(14,"div",5)(15,"p",3),r._uU(16,"Opponent Ship Cells Left"),r.qZA(),r.TgZ(17,"p",4),r._uU(18),r.ALo(19,"async"),r.qZA()()(),r.TgZ(20,"div",6),r.YNc(21,mt,3,3,"ng-container",7),r.ALo(22,"async"),r.YNc(23,Pt,5,2,"table",8),r.ALo(24,"async"),r.qZA(),r.TgZ(25,"div",9)(26,"button",10),r.NdJ("click",function(){return n.fireShot()}),r.ALo(27,"async"),r._uU(28," Fire shot "),r.qZA()(),r.TgZ(29,"div",11)(30,"div",12),r.ALo(31,"async"),r.TgZ(32,"div",13)(33,"strong",14),r._uU(34,"Battleship3"),r.qZA()(),r.TgZ(35,"div",15),r._uU(36,"Firing shot..."),r.qZA()()()),2&t&&(r.Q6J("ngSwitch",r.lcZ(1,13,n.turnStatus$)),r.xp6(2),r.Q6J("ngSwitchCase",n.TurnStatus.WaitingForOpponent),r.xp6(1),r.Q6J("ngSwitchCase",n.TurnStatus.PlayerTurn),r.xp6(1),r.Q6J("ngSwitchCase",n.TurnStatus.OpponentTurn),r.xp6(1),r.Q6J("ngSwitchCase",n.TurnStatus.PlayerWon),r.xp6(1),r.Q6J("ngSwitchCase",n.TurnStatus.PlayerLost),r.xp6(6),r.Oqu(r.lcZ(13,15,n.playerCellsLeft$)),r.xp6(6),r.Oqu(r.lcZ(19,17,n.opponentCellsLeft$)),r.xp6(3),r.Q6J("ngIf",r.lcZ(22,19,n.playerShipOccupancyBoard$)),r.xp6(2),r.Q6J("ngIf",r.lcZ(24,21,n.playerShotsBoard$)),r.xp6(3),r.Q6J("disabled",!r.lcZ(27,23,n.playerCanFireShot$)),r.xp6(4),r.ekj("show",r.lcZ(31,25,n.playerFiringShot$)))},directives:[S.RF,S.n9,S.O5,S.sg],pipes:[S.Ov],styles:["th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{width:48px;height:48px;text-align:center}td[_ngcontent-%COMP%]{border:1px solid #1a1a1a}#player-ships-board[_ngcontent-%COMP%]   td.shot-miss[_ngcontent-%COMP%]{background-color:#eceeef}#player-ships-board[_ngcontent-%COMP%]   td.shot-hit[_ngcontent-%COMP%]{color:#f8f9fa;background-color:#d9534f}#player-shots-board[_ngcontent-%COMP%]   td.selected[_ngcontent-%COMP%]{background-color:#55595c}#player-shots-board[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(.selected):not(.shot-present):hover{background-color:#adb5bd}#player-shots-board[_ngcontent-%COMP%]   td.shot-miss[_ngcontent-%COMP%]{background-color:#eceeef}#player-shots-board[_ngcontent-%COMP%]   td.shot-hit[_ngcontent-%COMP%]{color:#f8f9fa;background-color:#4bbf73}"]}),i})();function Bt(i,e){if(1&i&&(r.TgZ(0,"a",10)(1,"div",11),r._uU(2),r.qZA(),r.TgZ(3,"p",1),r._uU(4),r.qZA()()),2&i){const t=e.$implicit;r.MGl("routerLink","/games/",t.id,"/join"),r.xp6(2),r.hij("Game ",t.id,""),r.xp6(2),r.hij("Started by: ",t.startedBy,"")}}function Nt(i,e){if(1&i&&(r.TgZ(0,"div",8),r.YNc(1,Bt,5,3,"a",9),r.qZA()),2&i){const t=r.oxw().$implicit;r.xp6(1),r.Q6J("ngForOf",t)}}function Mt(i,e){1&i&&(r.TgZ(0,"div",12)(1,"p"),r._uU(2,"No started games to show"),r.qZA()())}function $t(i,e){if(1&i&&(r.ynx(0),r.YNc(1,Nt,2,1,"div",6),r.YNc(2,Mt,3,0,"ng-template",null,7,r.W1O),r.BQk()),2&i){const t=e.$implicit,n=r.MAs(3);r.xp6(1),r.Q6J("ngIf",t.length>0)("ngIfElse",n)}}function Zt(i,e){1&i&&(r.TgZ(0,"div",12)(1,"div",13)(2,"span",14),r._uU(3,"Loading..."),r.qZA()()())}const Ft=[{path:"",pathMatch:"full",component:(()=>{class i{constructor(t){this.startedGamesGql=t,this.startedGames$=this.startedGamesGql.watch(void 0,{pollInterval:6e4}).valueChanges.pipe((0,v.U)(({data:n})=>n.games))}ngOnInit(){}}return i.\u0275fac=function(t){return new(t||i)(r.Y36(it))},i.\u0275cmp=r.Xpm({type:i,selectors:[["app-games-list"]],decls:13,vars:4,consts:[[1,"d-flex","justify-content-between","align-items-center","my-3"],[1,"m-0"],[1,"text-end","flex-grow-1"],["routerLink","/games/create",1,"btn","btn-primary","m-0"],[4,"ngIf","ngIfElse"],["loadingStartedGames",""],["class","list-group",4,"ngIf","ngIfElse"],["noStartedGames",""],[1,"list-group"],["class","list-group-item list-group-item-action",3,"routerLink",4,"ngFor","ngForOf"],[1,"list-group-item","list-group-item-action",3,"routerLink"],[1,"fw-bold"],[1,"text-center","my-5"],["role","status",1,"spinner-border"],[1,"visually-hidden"]],template:function(t,n){if(1&t&&(r.TgZ(0,"div",0)(1,"div")(2,"h1"),r._uU(3,"Started Games"),r.qZA(),r.TgZ(4,"p",1),r._uU(5,"Click a game to join!"),r.qZA()(),r.TgZ(6,"div",2)(7,"a",3),r._uU(8,"Create game"),r.qZA()()(),r.YNc(9,$t,4,2,"ng-container",4),r.ALo(10,"async"),r.YNc(11,Zt,4,0,"ng-template",null,5,r.W1O)),2&t){const s=r.MAs(12);r.xp6(9),r.Q6J("ngIf",r.lcZ(10,2,n.startedGames$))("ngIfElse",s)}},directives:[M.yS,S.O5,S.sg],pipes:[S.Ov],styles:[""]}),i})()},{path:"create",component:Xe},{path:":gameId/join",component:Ke},{path:":gameId/play",component:Ot}];let Vt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[M.Bz.forChild(Ft)],M.Bz]}),i})(),zt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[S.ez,M.Bz]]}),i})(),se=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[S.ez]]}),i})(),Dt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[S.ez,se]]}),i})(),Ut=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[S.ez,se]]}),i})(),Lt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[S.ez]]}),i})(),kt=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=r.oAB({type:i}),i.\u0275inj=r.cJS({imports:[[S.ez,zt,Dt,Ut,Lt,Vt]]}),i})()}}]);